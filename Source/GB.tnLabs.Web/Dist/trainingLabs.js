function wizardButtonDirective(action){angular.module("mgo-angular-wizard").directive(action,function(){return{restrict:"A",replace:!1,require:"^wizard",link:function($scope,$element,$attrs,wizard){$element.on("click",function(e){e.preventDefault(),$scope.$apply(function(){$scope.$eval($attrs[action]),wizard[action.replace("wz","").toLowerCase()]()})})}}})}angular.module("templates-angularwizard",["step.html","wizard.html"]),angular.module("step.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("step.html",'<section ng-show="selected" ng-class="{current: selected, done: completed}" class="step" ng-transclude>\n</section>')}]),angular.module("wizard.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("wizard.html",'<div>\n    <div class="steps" ng-transclude></div>\n    <ul class="steps-indicator steps-{{steps.length}}" ng-if="!hideIndicators">\n      <li ng-class="{default: !step.completed && !step.selected, current: step.selected && !step.completed, done: step.completed && !step.selected, editing: step.selected && step.completed}" ng-repeat="step in steps">\n        <a ng-click="goTo(step)">{{step.title || step.wzTitle}}</a>\n      </li>\n    </ul>\n</div>\n')}]),angular.module("mgo-angular-wizard",["templates-angularwizard"]),angular.module("mgo-angular-wizard").directive("wzStep",function(){return{restrict:"EA",replace:!0,transclude:!0,scope:{wzTitle:"@",title:"@"},require:"^wizard",templateUrl:function(element,attributes){return attributes.template||"step.html"},link:function($scope,$element,$attrs,wizard){$scope.title=$scope.title||$scope.wzTitle,wizard.addStep($scope)}}}),angular.module("mgo-angular-wizard").directive("wizard",function(){return{restrict:"EA",replace:!0,transclude:!0,scope:{currentStep:"=",onFinish:"&",hideIndicators:"=",editMode:"=",name:"@"},templateUrl:function(element,attributes){return attributes.template||"wizard.html"},controller:["$scope","$element","WizardHandler",function($scope,$element,WizardHandler){function unselectAll(){_.each($scope.steps,function(step){step.selected=!1}),$scope.selectedStep=null}WizardHandler.addWizard($scope.name||WizardHandler.defaultName,this),$scope.$on("$destroy",function(){WizardHandler.removeWizard($scope.name||WizardHandler.defaultName)}),$scope.steps=[],$scope.$watch("currentStep",function(step){if(step){var stepTitle=$scope.selectedStep.title||$scope.selectedStep.wzTitle;$scope.selectedStep&&stepTitle!==$scope.currentStep&&$scope.goTo(_.findWhere($scope.steps,{title:$scope.currentStep}))}}),$scope.$watch("[editMode, steps.length]",function(){var editMode=$scope.editMode;_.isUndefined(editMode)||_.isNull(editMode)||editMode&&_.each($scope.steps,function(step){step.completed=!0})},!0),this.addStep=function(step){$scope.steps.push(step),1===$scope.steps.length&&$scope.goTo($scope.steps[0])},$scope.goTo=function(step){unselectAll(),$scope.selectedStep=step,_.isUndefined($scope.currentStep)||($scope.currentStep=step.title||step.wzTitle),step.selected=!0,$scope.$emit("wizard:stepChanged",{step:step,index:_.indexOf($scope.steps,step)})},this.next=function(draft){var index=_.indexOf($scope.steps,$scope.selectedStep);draft||($scope.selectedStep.completed=!0),index===$scope.steps.length-1?this.finish():$scope.goTo($scope.steps[index+1])},this.goTo=function(step){var stepTo;stepTo=_.isNumber(step)?$scope.steps[step]:_.findWhere($scope.steps,{title:step}),$scope.goTo(stepTo)},this.finish=function(){$scope.onFinish&&$scope.onFinish()},this.cancel=this.previous=function(){var index=_.indexOf($scope.steps,$scope.selectedStep);if(0===index)throw new Error("Can't go back. It's already in step 0");$scope.goTo($scope.steps[index-1])}}]}}),wizardButtonDirective("wzNext"),wizardButtonDirective("wzPrevious"),wizardButtonDirective("wzFinish"),wizardButtonDirective("wzCancel"),angular.module("mgo-angular-wizard").factory("WizardHandler",function(){var service={},wizards={};return service.defaultName="defaultWizard",service.addWizard=function(name,wizard){wizards[name]=wizard},service.removeWizard=function(name){delete wizards[name]},service.wizard=function(name){var nameToUse=name;return name||(nameToUse=service.defaultName),wizards[nameToUse]},service});
!function($,window,document,undefined){"use strict";var Timepicker=function(element,options){this.widget="",this.$element=$(element),this.defaultTime=options.defaultTime,this.disableFocus=options.disableFocus,this.isOpen=options.isOpen,this.minuteStep=options.minuteStep,this.modalBackdrop=options.modalBackdrop,this.secondStep=options.secondStep,this.showInputs=options.showInputs,this.showMeridian=options.showMeridian,this.showSeconds=options.showSeconds,this.template=options.template,this.appendWidgetTo=options.appendWidgetTo,this._init()};Timepicker.prototype={constructor:Timepicker,_init:function(){var self=this;this.$element.parent().hasClass("input-append")||this.$element.parent().hasClass("input-prepend")?(this.$element.parent(".input-append, .input-prepend").find(".add-on").on({"click.timepicker":$.proxy(this.showWidget,this)}),this.$element.on({"focus.timepicker":$.proxy(this.highlightUnit,this),"click.timepicker":$.proxy(this.highlightUnit,this),"keydown.timepicker":$.proxy(this.elementKeydown,this),"blur.timepicker":$.proxy(this.blurElement,this)})):this.$element.on(this.template?{"focus.timepicker":$.proxy(this.showWidget,this),"click.timepicker":$.proxy(this.showWidget,this),"blur.timepicker":$.proxy(this.blurElement,this)}:{"focus.timepicker":$.proxy(this.highlightUnit,this),"click.timepicker":$.proxy(this.highlightUnit,this),"keydown.timepicker":$.proxy(this.elementKeydown,this),"blur.timepicker":$.proxy(this.blurElement,this)}),this.$widget=this.template!==!1?$(this.getTemplate()).prependTo(this.$element.parents(this.appendWidgetTo)).on("click",$.proxy(this.widgetClick,this)):!1,this.showInputs&&this.$widget!==!1&&this.$widget.find("input").each(function(){$(this).on({"click.timepicker":function(){$(this).select()},"keydown.timepicker":$.proxy(self.widgetKeydown,self)})}),this.setDefaultTime(this.defaultTime)},blurElement:function(){this.highlightedUnit=undefined,this.updateFromElementVal()},decrementHour:function(){if(this.showMeridian)if(1===this.hour)this.hour=12;else{if(12===this.hour)return this.hour--,this.toggleMeridian();if(0===this.hour)return this.hour=11,this.toggleMeridian();this.hour--}else 0===this.hour?this.hour=23:this.hour--;this.update()},decrementMinute:function(step){var newVal;newVal=step?this.minute-step:this.minute-this.minuteStep,0>newVal?(this.decrementHour(),this.minute=newVal+60):this.minute=newVal,this.update()},decrementSecond:function(){var newVal=this.second-this.secondStep;0>newVal?(this.decrementMinute(!0),this.second=newVal+60):this.second=newVal,this.update()},elementKeydown:function(e){switch(e.keyCode){case 9:switch(this.updateFromElementVal(),this.highlightedUnit){case"hour":e.preventDefault(),this.highlightNextUnit();break;case"minute":(this.showMeridian||this.showSeconds)&&(e.preventDefault(),this.highlightNextUnit());break;case"second":this.showMeridian&&(e.preventDefault(),this.highlightNextUnit())}break;case 27:this.updateFromElementVal();break;case 37:e.preventDefault(),this.highlightPrevUnit(),this.updateFromElementVal();break;case 38:switch(e.preventDefault(),this.highlightedUnit){case"hour":this.incrementHour(),this.highlightHour();break;case"minute":this.incrementMinute(),this.highlightMinute();break;case"second":this.incrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian()}break;case 39:e.preventDefault(),this.updateFromElementVal(),this.highlightNextUnit();break;case 40:switch(e.preventDefault(),this.highlightedUnit){case"hour":this.decrementHour(),this.highlightHour();break;case"minute":this.decrementMinute(),this.highlightMinute();break;case"second":this.decrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian()}}},formatTime:function(hour,minute,second,meridian){return hour=10>hour?"0"+hour:hour,minute=10>minute?"0"+minute:minute,second=10>second?"0"+second:second,hour+":"+minute+(this.showSeconds?":"+second:"")+(this.showMeridian?" "+meridian:"")},getCursorPosition:function(){var input=this.$element.get(0);if("selectionStart"in input)return input.selectionStart;if(document.selection){input.focus();var sel=document.selection.createRange(),selLen=document.selection.createRange().text.length;return sel.moveStart("character",-input.value.length),sel.text.length-selLen}},getTemplate:function(){var template,hourTemplate,minuteTemplate,secondTemplate,meridianTemplate,templateContent;switch(this.showInputs?(hourTemplate='<input type="text" name="hour" class="bootstrap-timepicker-hour form-control" maxlength="2"/>',minuteTemplate='<input type="text" name="minute" class="bootstrap-timepicker-minute form-control" maxlength="2"/>',secondTemplate='<input type="text" name="second" class="bootstrap-timepicker-second form-control" maxlength="2"/>',meridianTemplate='<input type="text" name="meridian" class="bootstrap-timepicker-meridian form-control" maxlength="2"/>'):(hourTemplate='<span class="bootstrap-timepicker-hour"></span>',minuteTemplate='<span class="bootstrap-timepicker-minute"></span>',secondTemplate='<span class="bootstrap-timepicker-second"></span>',meridianTemplate='<span class="bootstrap-timepicker-meridian"></span>'),templateContent='<table><tr><td><a href="#" data-action="incrementHour"><i class="glyphicon glyphicon-chevron-up"></i></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><i class="glyphicon glyphicon-chevron-up"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><i class="glyphicon glyphicon-chevron-up"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><i class="glyphicon glyphicon-chevron-up"></i></a></td>':"")+"</tr><tr><td>"+hourTemplate+'</td> <td class="separator">:</td><td>'+minuteTemplate+"</td> "+(this.showSeconds?'<td class="separator">:</td><td>'+secondTemplate+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td>'+meridianTemplate+"</td>":"")+'</tr><tr><td><a href="#" data-action="decrementHour"><i class="glyphicon glyphicon-chevron-down"></i></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><i class="glyphicon glyphicon-chevron-down"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><i class="glyphicon glyphicon-chevron-down"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><i class="glyphicon glyphicon-chevron-down"></i></a></td>':"")+"</tr></table>",this.template){case"modal":template='<div class="bootstrap-timepicker-widget modal hide fade in" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">Ã—</a><h3>Pick a Time</h3></div><div class="modal-content">'+templateContent+'</div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">OK</a></div></div>';break;case"dropdown":template='<div class="bootstrap-timepicker-widget dropdown-menu">'+templateContent+"</div>"}return template},getTime:function(){return this.formatTime(this.hour,this.minute,this.second,this.meridian)},hideWidget:function(){this.isOpen!==!1&&(this.showInputs&&this.updateFromWidgetInputs(),this.$element.trigger({type:"hide.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}}),"modal"===this.template&&this.$widget.modal?this.$widget.modal("hide"):this.$widget.removeClass("open"),$(document).off("mousedown.timepicker"),this.isOpen=!1)},highlightUnit:function(){this.position=this.getCursorPosition(),this.position>=0&&this.position<=2?this.highlightHour():this.position>=3&&this.position<=5?this.highlightMinute():this.position>=6&&this.position<=8?this.showSeconds?this.highlightSecond():this.highlightMeridian():this.position>=9&&this.position<=11&&this.highlightMeridian()},highlightNextUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":this.showSeconds?this.highlightSecond():this.showMeridian?this.highlightMeridian():this.highlightHour();break;case"second":this.showMeridian?this.highlightMeridian():this.highlightHour();break;case"meridian":this.highlightHour()}},highlightPrevUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMeridian();break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":this.showSeconds?this.highlightSecond():this.highlightMinute()}},highlightHour:function(){var $element=this.$element.get(0);this.highlightedUnit="hour",$element.setSelectionRange&&setTimeout(function(){$element.setSelectionRange(0,2)},0)},highlightMinute:function(){var $element=this.$element.get(0);this.highlightedUnit="minute",$element.setSelectionRange&&setTimeout(function(){$element.setSelectionRange(3,5)},0)},highlightSecond:function(){var $element=this.$element.get(0);this.highlightedUnit="second",$element.setSelectionRange&&setTimeout(function(){$element.setSelectionRange(6,8)},0)},highlightMeridian:function(){var $element=this.$element.get(0);this.highlightedUnit="meridian",$element.setSelectionRange&&(this.showSeconds?setTimeout(function(){$element.setSelectionRange(9,11)},0):setTimeout(function(){$element.setSelectionRange(6,8)},0))},incrementHour:function(){if(this.showMeridian){if(11===this.hour)return this.hour++,this.toggleMeridian();12===this.hour&&(this.hour=0)}return 23===this.hour?void(this.hour=0):(this.hour++,void this.update())},incrementMinute:function(step){var newVal;newVal=step?this.minute+step:this.minute+this.minuteStep-this.minute%this.minuteStep,newVal>59?(this.incrementHour(),this.minute=newVal-60):this.minute=newVal,this.update()},incrementSecond:function(){var newVal=this.second+this.secondStep-this.second%this.secondStep;newVal>59?(this.incrementMinute(!0),this.second=newVal-60):this.second=newVal,this.update()},remove:function(){$("document").off(".timepicker"),this.$widget&&this.$widget.remove(),delete this.$element.data().timepicker},setDefaultTime:function(defaultTime){if(this.$element.val())this.updateFromElementVal();else if("current"===defaultTime){var dTime=new Date,hours=dTime.getHours(),minutes=Math.floor(dTime.getMinutes()/this.minuteStep)*this.minuteStep,seconds=Math.floor(dTime.getSeconds()/this.secondStep)*this.secondStep,meridian="AM";this.showMeridian&&(0===hours?hours=12:hours>=12?(hours>12&&(hours-=12),meridian="PM"):meridian="AM"),this.hour=hours,this.minute=minutes,this.second=seconds,this.meridian=meridian,this.update()}else defaultTime===!1?(this.hour=0,this.minute=0,this.second=0,this.meridian="AM"):this.setTime(defaultTime)},setTime:function(time){var arr,timeArray;this.showMeridian?(arr=time.split(" "),timeArray=arr[0].split(":"),this.meridian=arr[1]):timeArray=time.split(":"),this.hour=parseInt(timeArray[0],10),this.minute=parseInt(timeArray[1],10),this.second=parseInt(timeArray[2],10),isNaN(this.hour)&&(this.hour=0),isNaN(this.minute)&&(this.minute=0),this.showMeridian?(this.hour>12?this.hour=12:this.hour<1&&(this.hour=12),"am"===this.meridian||"a"===this.meridian?this.meridian="AM":("pm"===this.meridian||"p"===this.meridian)&&(this.meridian="PM"),"AM"!==this.meridian&&"PM"!==this.meridian&&(this.meridian="AM")):this.hour>=24?this.hour=23:this.hour<0&&(this.hour=0),this.minute<0?this.minute=0:this.minute>=60&&(this.minute=59),this.showSeconds&&(isNaN(this.second)?this.second=0:this.second<0?this.second=0:this.second>=60&&(this.second=59)),this.update()},showWidget:function(){if(!this.isOpen&&!this.$element.is(":disabled")){var self=this;$(document).on("mousedown.timepicker",function(e){0===$(e.target).closest(".bootstrap-timepicker-widget").length&&self.hideWidget()}),this.$element.trigger({type:"show.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}}),this.disableFocus&&this.$element.blur(),this.updateFromElementVal(),"modal"===this.template&&this.$widget.modal?this.$widget.modal("show").on("hidden",$.proxy(this.hideWidget,this)):this.isOpen===!1&&this.$widget.addClass("open"),this.isOpen=!0}},toggleMeridian:function(){this.meridian="AM"===this.meridian?"PM":"AM",this.update()},update:function(){this.$element.trigger({type:"changeTime.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}}),this.updateElement(),this.updateWidget()},updateElement:function(){this.$element.val(this.getTime()).change()},updateFromElementVal:function(){var val=this.$element.val();val&&this.setTime(val)},updateWidget:function(){if(this.$widget!==!1){var hour=this.hour<10?"0"+this.hour:this.hour,minute=this.minute<10?"0"+this.minute:this.minute,second=this.second<10?"0"+this.second:this.second;this.showInputs?(this.$widget.find("input.bootstrap-timepicker-hour").val(hour),this.$widget.find("input.bootstrap-timepicker-minute").val(minute),this.showSeconds&&this.$widget.find("input.bootstrap-timepicker-second").val(second),this.showMeridian&&this.$widget.find("input.bootstrap-timepicker-meridian").val(this.meridian)):(this.$widget.find("span.bootstrap-timepicker-hour").text(hour),this.$widget.find("span.bootstrap-timepicker-minute").text(minute),this.showSeconds&&this.$widget.find("span.bootstrap-timepicker-second").text(second),this.showMeridian&&this.$widget.find("span.bootstrap-timepicker-meridian").text(this.meridian))}},updateFromWidgetInputs:function(){if(this.$widget!==!1){var time=$("input.bootstrap-timepicker-hour",this.$widget).val()+":"+$("input.bootstrap-timepicker-minute",this.$widget).val()+(this.showSeconds?":"+$("input.bootstrap-timepicker-second",this.$widget).val():"")+(this.showMeridian?" "+$("input.bootstrap-timepicker-meridian",this.$widget).val():"");this.setTime(time)}},widgetClick:function(e){e.stopPropagation(),e.preventDefault();var action=$(e.target).closest("a").data("action");action&&this[action]()},widgetKeydown:function(e){var $input=$(e.target).closest("input"),name=$input.attr("name");switch(e.keyCode){case 9:if(this.showMeridian){if("meridian"===name)return this.hideWidget()}else if(this.showSeconds){if("second"===name)return this.hideWidget()}else if("minute"===name)return this.hideWidget();this.updateFromWidgetInputs();break;case 27:this.hideWidget();break;case 38:switch(e.preventDefault(),name){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian()}break;case 40:switch(e.preventDefault(),name){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian()}}}},$.fn.timepicker=function(option){var args=Array.apply(null,arguments);return args.shift(),this.each(function(){var $this=$(this),data=$this.data("timepicker"),options="object"==typeof option&&option;data||$this.data("timepicker",data=new Timepicker(this,$.extend({},$.fn.timepicker.defaults,options,$(this).data()))),"string"==typeof option&&data[option].apply(data,args)})},$.fn.timepicker.defaults={defaultTime:"current",disableFocus:!1,isOpen:!1,minuteStep:15,modalBackdrop:!1,secondStep:15,showSeconds:!1,showInputs:!0,showMeridian:!0,template:"dropdown",appendWidgetTo:".bootstrap-timepicker"},$.fn.timepicker.Constructor=Timepicker}(jQuery,window,document);
!function(window){"use strict";function breezeProvider(){function breezeFactory($http,$q){function useNgHttp(){var ajax=breeze.config.initializeAdapterInstance("ajax","angular",!0);ajax.setHttp($http)}function useNgPromises(){if(breeze.Q=$q,!breeze.config.setQ)throw new Error("Cannot use the breeze angular service with breeze.version="+breeze.version);breeze.config.setQ($q),$q.resolve=$q.fcall=$q.when}return useNgHttp(),useNgPromises(),breeze}function initializeDataServiceAdapter(adapterName,isDefault){return breeze.config.initializeAdapterInstance("dataService",adapterName,isDefault)}var breeze=window.breeze;breeze.config.initializeAdapterInstance("modelLibrary","backingStore",!0),this.breeze=breeze,this.NamingConvention=breeze.NamingConvention,this.initializeDataServiceAdapter=initializeDataServiceAdapter,this.$get=["$http","$q",breezeFactory]}angular.module("breeze.angular",[],["$provide",function($provide){$provide.provider({breeze:breezeProvider})}])}(this);
!function(){"use strict";function zFloat(){return{restrict:"A",require:"ngModel",link:function(scope,elm,attr,ngModelCtrl){function equivalenceFormatter(value){var viewValue=ngModelCtrl.$viewValue;return value===+viewValue?viewValue:value}"radio"!==attr.type&&"checkbox"!==attr.type&&ngModelCtrl.$formatters.push(equivalenceFormatter)}}}function zValidate(config,validateInfo){function link(scope,element,attrs){function linkForInput(){function valErrsChanged(newValue){domEl.setCustomValidity&&domEl.setCustomValidity(newValue);var errorHtml=newValue?valTemplate.replace(/%error%/,newValue):"",isRequired=info.getIsRequired(),requiredHtml=isRequired?requiredTemplate:"";decorator.innerHTML=isRequired||errorHtml?requiredHtml+errorHtml:""}var valTemplate=config.zValidateTemplate,requiredTemplate=config.zRequiredTemplate||"",decorator=angular.element('<span class="z-decorator"></span>');element.after(decorator),decorator=decorator[0],scope.$watch(info.getValErrs,valErrsChanged)}function linkForNonInput(){function valErrsChanged(newValue){var errorMsg=newValue?newValue:"";scope.z_error=errorMsg,scope.z_invalid=!!errorMsg,scope.z_required=info.getIsRequired()}scope.$watch(info.getValErrs,valErrsChanged)}var info=validateInfo.create(scope,attrs.ngModel,attrs.zValidate);if(info.getValErrs){var domEl=element[0],nodeName=domEl.nodeName,isInput="INPUT"==nodeName||"SELECT"==nodeName||"TEXTAREA"==nodeName;isInput?linkForInput():linkForNonInput()}}var directive={link:link,restrict:"A",scope:!0};return directive}function zValidateInfo(){function Info(scope,modelPath,validationPath){(modelPath||validationPath)&&(this.scope=scope,setEntityAndPropertyPaths(this,modelPath,validationPath),this.getEntityAspect=this.entityPath?getEntityAspectFromEntityPath(this):getEntityAspect(this),this.getValErrs=createGetValErrs(this),this.isRequired=void 0)}function create(scope,modelPath,validationPath){return new Info(scope,modelPath,validationPath)}function createGetValErrs(info){return function(){var aspect=info.getEntityAspect();if(aspect){var errs=aspect.getValidationErrors(info.propertyPath);return errs.length?errs.map(function(e){return e.errorMessage}).join("; "):""}return null}}function getEntityAspect(info){return function(){return info.scope.entityAspect}}function getEntityAspectFromEntityPath(info){return function(){try{return info.scope.$eval(info.entityPath).entityAspect}catch(_){return void 0}}}function getIsRequired(){var info=this;if(void 0!==info.isRequired)return info.isRequired;var entityType=info.getType();if(entityType){var requiredProperties=getRequiredPropertiesForEntityType(entityType);return info.isRequired=!!requiredProperties[info.propertyPath]}return void 0}function getType(){var aspect=this.getEntityAspect();return aspect?aspect.entity.entityType:null}function getRequiredPropertiesForEntityType(type){if(type.custom&&type.custom.required)return type.custom.required;type.custom||(type.custom={});var required={};type.custom.required=required;var props=type.getProperties();return props.forEach(function(prop){for(var vals=prop.validators,i=vals.length;i--;){var val=vals[i];if(val.context.isRequired||"required"===val.name){required[prop.name]=!0;break}}}),required}function setEntityAndPropertyPaths(info,modelPath,validationPath){function parsePath(path){"]"===path[path.length-1]?parseIndexedPaths(path):parseDottedPath(path)}function parseDottedPath(path){paths=path.split("."),info.propertyPath=paths.pop(),info.entityPath=paths.join(".")}function parseIndexedPaths(path){var opensb=path.lastIndexOf("[");info.entityPath=path.substring(0,opensb);var propertyPath=path.substring(opensb+1,path.length-1);try{var evalPath=info.scope.$eval(propertyPath)}catch(_){}info.propertyPath=evalPath?evalPath:propertyPath}if(modelPath&&parsePath(modelPath),validationPath){var paths=validationPath.split(","),pPath=paths.pop(),ePath=paths.pop();ePath&&(info.entityPath=ePath.trim()),info.entityPath?info.propertyPath=pPath:parsePath(pPath)}}return Info.prototype={constructor:Info,getIsRequired:getIsRequired,getType:getType},{create:create}}function zDirectivesConfig(){this.zValidateTemplate='<span class="invalid">%error%</span>',this.zRequiredTemplate='<span class="icon-asterisk-invalid z-required" title="Required">*</span>',this.$get=function(){return{zValidateTemplate:this.zValidateTemplate,zRequiredTemplate:this.zRequiredTemplate}}}angular.module("breeze.directives",[]).directive("zFloat",[zFloat]).directive("zValidate",["zDirectivesConfig","zValidateInfo",zValidate]).service("zValidateInfo",zValidateInfo).provider("zDirectivesConfig",zDirectivesConfig)}();
!function(definition,window){if(window.breeze)definition(window.breeze);else if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){var b=require("breeze");definition(b)}else{if("function"!=typeof define||!define.amd||window.breeze)throw new Error("Can't find breeze");define(["breeze"],definition)}}(function(breeze){"use strict";function getErrorMessage(error){var msg=error.message,entityErrors=error.entityErrors;return entityErrors&&entityErrors.length?(service.reviewServerErrors(entityErrors),getValidationMessages(entityErrors)):msg}function getValidationMessages(entityErrors){var isServerError=entityErrors[0].isServerError;try{return entityErrors.map(service.getMessageFromEntityError).join("; <br/>")}catch(e){return(isServerError?"server":"client")+" validation error"}}function getMessageFromEntityError(entityError){var entity=entityError.entity;if(entity)var name=service.getEntityName(entity);return name=name?name+=" - ":"",name+"'"+entityError.errorMessage+"'"}function getEntityName(entity){var key=entity.entityAspect.getKey(),name=key.entityType.shortName,id=key.values.join(",");return name+" ("+id+")"}function reviewServerErrors(entityErrors){var entitiesWithServerErrors=[];entityErrors.forEach(function(entityError){var entity=entityError.isServerError&&entityError.entity;entity&&-1===entitiesWithServerErrors.indexOf(entity)&&(entitiesWithServerErrors.push(entity),clearServerErrorsOnNextChange(entity))})}function clearServerErrorsOnNextChange(badEntity){badEntity.entityAspect.entityState.isDetached()||!function(entity){var manager=entity.entityAspect.entityManager,subKey=manager.entityChanged.subscribe(function(changeArgs){if(changeArgs.entity===entity){manager.entityChanged.unsubscribe(subKey);var aspect=entity.entityAspect;aspect.getValidationErrors().forEach(function(err){err.isServerError&&aspect.removeValidationError(err)})}})}(badEntity)}var service={getErrorMessage:getErrorMessage,getEntityName:getEntityName,getMessageFromEntityError:getMessageFromEntityError,reviewServerErrors:reviewServerErrors};breeze.saveErrorMessageService=service},this);
!function(module){try{module=angular.module("app")}catch(e){module=angular.module("app",[])}module.run(["$templateCache",function($templateCache){$templateCache.put("app/dashboard/dashboard.html",'<div id="dashboard-view" class="container" data-ng-controller="dashboard as vm"><div class="row"><div class="col-md-12"><ul class="today-datas"><li class="borange grow "><a href="#/session/{{vm.nextSession.sessionId}}"><div class="pull-left"><i class="fa fa-bookmark"></i></div><div class="datas-text pull-right"><span class="bold">{{vm.nextSession.sessionName}} - {{vm.nextSession.sessionUsers.length}} participants</span> {{vm.nextSession.formattedStartDate}}</div><div class="clearfix"></div></a></li><li class="borange grow "><a href="#/participant/new"><div class="pull-left"><i class="fa fa-users"></i></div><div class="datas-text pull-left"><span class="bold">Create User</span>Session participants</div><div class="clearfix"></div></a></li></ul></div></div><hr><div class="row"><div class="col-md-7"><div class="box"><div class="box-header"><h2><i class="fa fa-calendar"></i> <span class="break"></span> Upcoming 3 Sessions</h2></div><div class="box-content"><div data-ng-if="vm.sessions.length == 0"><h1 class="padding">There are no upcoming sessions scheduled.</h1></div><table data-ng-if="vm.sessions.length > 0" class="table table-hover table-striped"><thead><tr><th>Session Name</th><th>Start Date</th><th>Lab Name</th></tr></thead><tbody><tr data-ng-repeat="s in vm.sessions" data-ng-click="vm.gotoSession(s)" class="pointer"><td>{{s.sessionName}}</td><td>{{s.formattedStartDate}}</td><td>{{s.lab.name}}</td></tr></tbody></table></div></div></div><div class="col-md-5"><ul class="today-datas "><li class="bblue grow pull-right mediumBox"><a href="#/sessions"><div class="pull-left"><i class="fa fa-calendar"></i></div><div class="datas-text pull-right">{{vm.sessionsCount}}<span class="bold">Sessions</span></div><div class="clearfix"></div></a></li><li class="bblue grow pull-right mediumBox"><a href="#/session/new"><div class="pull-left"><i class="fa fa-comments"></i></div><div class="datas-text pull-right"><span class="bold">Create session</span>Schedule a new session</div><div class="clearfix"></div></a></li></ul></div></div><hr><div class="row"><div class="col-md-7"><div class="box"><div class="box-header"><h2><i class="fa fa-laptop"></i> <span class="break"></span> Latest labs created</h2></div><div class="box-content"><table class="table table-hover table-striped"><thead><tr><th>Lab Name</th><th>Description</th></tr></thead><tbody><tr data-ng-repeat="l in vm.labs" data-ng-click="vm.gotoLab(l)" class="pointer"><td>{{l.name}}</td><td>{{l.description}}</td></tr></tbody></table></div></div></div><div class="col-md-5"><ul class="today-datas "><li class="bdarkgreen grow pull-right mediumBox"><a href="#/labs"><div class="pull-left"><i class="fa fa-laptop"></i></div><div class="datas-text pull-right">{{vm.labsCount}}<span class="bold">Existing labs</span></div><div class="clearfix"></div></a></li><li class="bdarkgreen grow pull-right mediumBox"><a href="#/lab/new"><div class="pull-left"><i class="fa fa-send"></i></div><div class="datas-text pull-right"><span class="bold">Create lab</span>Create new lab template</div><div class="clearfix"></div></a></li></ul></div></div></div>')}])}(),function(module){try{module=angular.module("app")}catch(e){module=angular.module("app",[])}module.run(["$templateCache",function($templateCache){$templateCache.put("app/layout/shell.html",'<div data-ng-controller="shell as vm"><header class="clearfix"><div data-ng-include="\'/app/layout/topnav.html\'"></div></header><div class="container" data-resizable=""><div class="row"><div data-ng-show="vm.isBusy" class="page-splash dissolve-animation"><div data-cc-spinner="vm.spinnerOptions"></div><div class="page-splash-message page-splash-message-subtle">{{vm.busyMessage}}</div></div><div class="col-sm-2  main-menu-span"><div data-ng-include="\'/app/layout/sidebar.html\'"></div></div><div id="content" data-ng-view="" data-ng-class="{\'large\':\'col-sm-10 slide-animation\',\'small\':\'col-sm-11 slide-animation\'}[vm.size]" data-ng-style="vm.height()"></div></div><div class="clearfix"></div><footer><p><span style="text-align:left;float:left">&copy; {{vm.year}} Created by gbLabs.</span> <span class="hidden-xs" style="text-align:right;float:right">Version: <a href="https://trello.com/b/y7iXoYxp/tnlabs-features" target="_blank" alt="Version">{{vm.version}}</a></span></p></footer></div></div>')}])}(),function(module){try{module=angular.module("app")}catch(e){module=angular.module("app",[])}module.run(["$templateCache",function($templateCache){$templateCache.put("app/layout/sidebar.html",'<div data-ng-controller="sidebar as vm"><div class="sidebar-nav nav-collapse collapse navbar-collapse"><ul class="nav nav-tabs nav-stacked main-menu"><li data-ng-class="vm.isCurrent(r)" data-ng-repeat="r in vm.navRoutes"><a href="#{{r.url}}" data-ng-bind-html="r.config.settings.content"></a></li><li class="visible-xs"><a href="/login/logout"><i class="fa fa-sign-out"></i><span class="hidden-sm">Sign-out</span></a></li></ul></div></div>')}])}(),function(module){try{module=angular.module("app")}catch(e){module=angular.module("app",[])}module.run(["$templateCache",function($templateCache){$templateCache.put("app/layout/topnav.html",'<div class="navbar" data-ng-controller="topnav as vm"><div class="container"><button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".sidebar-nav.nav-collapse"><span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="#"><img src="../../Content/images/logo.png" alt="logo"><span>Training Labs</span>&nbsp;<span style="color:#646464;font-size:10px">beta</span></a><div class="pull-right hidden-xs"><ul class="nav navbar-nav"><li class="dropdown" on-toggle="toggled(open)"><a href="" class="dropdown-toggle"><i class="fa fa-tags"></i> Subscriptions</a><ul class="dropdown-menu"><li data-ng-repeat="s in vm.subscriptions"><a href="" data-ng-click="vm.changeSubscription(s)"><i class="fa" data-ng-class="vm.currentStyle(s.active)"></i>{{s.subscriptionName}}</a></li></ul></li><li class="hidden-xs"><a href="/login/logout"><i class="fa fa-sign-out"></i>Sign-out</a></li></ul></div></div></div>')}])}(),function(module){try{module=angular.module("app")}catch(e){module=angular.module("app",[])}module.run(["$templateCache",function($templateCache){$templateCache.put("app/layout/widgetheader.html",'<h2><i class="fa fa-tasks"></i><span class="break"></span>{{title}}</h2>')}])}(),function(module){try{module=angular.module("app")}catch(e){module=angular.module("app",[])}module.run(["$templateCache",function($templateCache){$templateCache.put("app/lab/labdetail.html",'<section data-ng-controller="labdetail as vm"><wizard on-finish="vm.createLab()" hide-indicators="true"><wz-step title="Lab Information"><h1>Please introduce lab information</h1><hr><div class="form-horizontal"><div class="form-group"><label class=" col-sm-2 control-label" for="inputLabName">Name</label><div class="col-sm-6"><input type="text" class="form-control" id="inputLabName" name="labName" data-z-validate="" placeholder="Lab name" data-ng-model="vm.lab.name"></div></div><div class="form-group"><label class="col-sm-2 control-label" for="inputDescription">Description</label><div class="col-sm-6"><textarea id="inputDescription" class="form-control" name="description" data-z-validate="" placeholder="Description" data-ng-model="vm.lab.description" rows="4">\n                    </textarea></div></div><div class="form-group"><div class="col-sm-8"><input type="submit" data-ng-click="vm.nextStep()" class="btn btn-success pull-right" value="Next"></div></div></div></wz-step><wz-step title="Select image" data-step-scroll-to-top=""><h1>Please select an existing template image</h1><hr><div class="row"><div class="col-sm-8"><div class="alert alert-danger alert-dismissable" data-ng-repeat="error in vm.errors"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">x</button> <span>{{error.errorMessage}}</span></div><div class="box"><div class="box-header"><h2><i class="fa fa-cloud-download"></i><span class="break"></span>Available template images</h2></div><div class="box-content"><table class="table table-striped"><tbody><tr data-ng-repeat="i in vm.availableCustomImages"><td><h1>{{i.friendlyName}}</h1><p>{{i.description}}</p></td><td><label class="switch switch-success"><input type="radio" name="images" class="switch-input" data-ng-value="i.name" data-ng-model="vm.lab.imageName"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></td></tr></tbody></table></div></div></div></div><div class="row"><div class="col-sm-8"><input type="submit" wz-previous="" class="btn btn-warning pull-left" value="Previous"> <input data-ng-if="!vm.createTemplateImage" type="submit" wz-finish="" class="btn btn-success pull-right" value="Finish"> <input data-ng-if="vm.createTemplateImage" type="submit" data-ng-click="vm.nextStep()" class="btn btn-success pull-right" value="Next"> <span data-ng-show="vm.isNew" class="pull-right margin-right padding"><label class="switch switch-success"><input type="checkbox" class="switch-input" data-ng-model="vm.createTemplateImage"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label> <span class="small-font">New template image</span></span></div></div></wz-step><wz-step data-step-scroll-to-top=""><h1>Select software to pre-install</h1><hr><div class="row"><div class="col-sm-8"><div class="box"><div class="box-header"><h2><i class="fa fa-cloud-download"></i><span class="break"></span>Available software packages</h2></div><div class="box-content"><table class="table table-striped"><tbody><tr data-ng-repeat="i in vm.availableChocoPackages"><td><h1>{{i.friendlyName}}</h1><p>{{i.description}}</p></td><td><label class="switch switch-success"><input type="checkbox" name="images" class="switch-input" data-ng-model="vm.selectedChocoPackages[i.packageName]"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></td></tr></tbody></table></div></div></div></div><div class="row"><div class="col-sm-8"><input type="submit" wz-previous="" class="btn btn-warning pull-left" value="Previous"> <input type="submit" wz-finish="" class="btn btn-success pull-right" value="Finish"></div></div></wz-step></wizard></section>')}])}(),function(module){try{module=angular.module("app")}catch(e){module=angular.module("app",[])}module.run(["$templateCache",function($templateCache){$templateCache.put("app/lab/labs.html",'<div class="container" data-ng-controller="labs as vm"><div class="row"><div class="col-sm-5 col-md-5 "><a href="#/lab/new" class="btn btn-success pull-left margin-right"><i class="fa fa-send"></i>&nbsp;Create lab</a></div></div><div class="row"><div class="box col-md-4 col-sm-12" data-ng-repeat="l in vm.filteredLabs"><div class="box-header"><h2><i class="fa fa-laptop"></i> <span class="break"></span> {{l.name}}</h2></div><div class="box-content tnList widget-content"><div class="padd"><dl><dt>Description:</dt><dd><p>{{l.description}}</p></dd></dl><div class="pull-right"><button class="btn btn-success" data-ng-click="vm.gotoLab(l)">Edit</button> <button class="btn btn-warning" data-ng-click="vm.removeLab(l)">Remove</button></div><div class="clearfix"></div></div></div></div></div></div>')}])}(),function(module){try{module=angular.module("app")}catch(e){module=angular.module("app",[])}module.run(["$templateCache",function($templateCache){$templateCache.put("app/session/sessiondetail.html",'<section data-ng-controller="sessiondetail as vm"><wizard on-finish="vm.createSession()" hide-indicators="true"><wz-step ng-enter-tab="vm.gotoLabs()" title="Session Information"><h1>Please introduce session information</h1><hr><div class="form-horizontal"><div class="form-group"><label class=" col-sm-2 control-label" for="inputSessionName">Name</label><div class="col-sm-6"><input type="text" class="form-control" id="inputSessionName" name="inputSessionName" data-z-validate="" placeholder="Session name" data-ng-model="vm.session.sessionName"></div></div><div class="form-group"><label class="col-sm-2 control-label">Computing</label><div class="col-sm-6"><div class="margin-right padding"><label class="switch switch-success"><input type="radio" class="switch-input" checked="checked" name="computing" value="Small" data-ng-model="vm.session.vmSize"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label> <span>Small (1 Core)</span></div><div class="margin-right padding"><label class="switch switch-success"><input type="radio" class="switch-input" name="computing" value="Medium" data-ng-model="vm.session.vmSize"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label> <span>Medium (2 Cores)</span></div><div class="margin-right padding"><label class="switch switch-success"><input type="radio" class="switch-input" name="computing" value="Large" data-ng-model="vm.session.vmSize"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label> <span>Large (4 Cores)</span></div></div></div><div class="form-group"><div class="col-sm-8"><input type="submit" data-ng-click="vm.gotoLabs()" class="btn btn-success pull-right" value="Next"></div></div></div></wz-step><wz-step title="Select lab" ng-enter-tab="vm.gotoSchedule()" data-step-scroll-to-top=""><h1>Please select a lab</h1><hr><div class="row"><div class="col-sm-8"><div class="alert alert-danger alert-dismissable" data-ng-repeat="error in vm.errors"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">x</button> <span>{{error.errorMessage}}</span></div><div class="box"><div class="box-header"><h2><i class="fa fa-laptop"></i><span class="break"></span>Available labs</h2></div><div class="box-content"><table class="table table-striped"><tbody><tr data-ng-repeat="l in vm.filteredLabs"><td><h1>{{l.name}}</h1><p>{{l.description}}</p></td><td><label class="switch switch-success"><input type="radio" name="images" class="switch-input" data-ng-value="l" data-ng-model="vm.session.lab"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></td></tr></tbody></table></div></div></div></div><div class="row"><div class="col-sm-8"><input type="submit" wz-previous="" class="btn btn-warning pull-left" value="Previous"> <input type="submit" data-ng-click="vm.gotoSchedule()" class="btn btn-success pull-right" value="Next"></div></div></wz-step><wz-step title="Session Schedule" ng-enter-tab="vm.gotoParticipants()"><h1>Please select a schedule</h1><hr><div class="form-horizontal"><div class="form-group"><label class=" col-sm-2 control-label" for="inputStartDate">Start date</label><div class="col-sm-6"><div class="input-group date col-sm-12"><span class="input-group-addon"><i class="fa fa-calendar"></i></span> <input type="text" class="form-control date-picker border-radius" id="inputStartDate" data-date-format="mm/dd/yyyy" data-date-picker="" data-z-validate="" placeholder="Start Date" data-ng-model="vm.session.date" mo-date-input="DD MMMM YYYY"></div></div></div><div class="form-group"><label class=" col-sm-2 control-label" for="inputStarTime">Start time</label><div class="col-sm-6"><div class="input-group date col-sm-12 bootstrap-timepicker"><span class="input-group-addon"><i class="fa fa-clock-o"></i></span> <input type="text" class="form-control timepicker border-radius" id="inputStarTime" data-time-picker="" data-z-validate="" placeholder="Start Time" data-ng-model="vm.session.startTime"></div></div></div><div class="form-group"><label class=" col-sm-2 control-label" for="inputEndTime">End time</label><div class="col-sm-6"><div class="input-group date col-sm-12 bootstrap-timepicker"><span class="input-group-addon"><i class="fa fa-clock-o"></i></span> <input type="text" class="form-control timepicker border-radius" id="inputEndTime" data-time-picker="" data-z-validate="" placeholder="End Time" data-ng-model="vm.session.endTime"></div></div></div><div class="form-group"><div class="col-sm-8"><input type="submit" wz-previous="" class="btn btn-warning pull-left" value="Previous"> <input type="submit" data-ng-click="vm.gotoParticipants()" class="btn btn-success pull-right" value="Next"></div></div></div></wz-step><wz-step title="Session Participants" data-step-scroll-to-top=""><h1>Please select participants</h1><hr><div class="form-horizontal"><div class="form-group"><div class="col-sm-8"><div class="alert alert-danger alert-dismissable" data-ng-repeat="error in vm.errors"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">x</button> <span>{{error.errorMessage}}</span></div></div></div><div class="form-group"><div class="col-sm-8"><div class="input-group date col-sm-12"><input type="text" class="form-control" id="inputSearchParticipants" placeholder="Search participant" data-ng-model="vm.selectedParticipant" ng-enter-tab="vm.addParticipantToSession()" typeahead="participant as participant.fullName for participant in vm.filteredParticipants | filter:{fullName:$viewValue} | limitTo:8"> <span class="input-group-addon btn btn-primary" data-ng-click="vm.addParticipantToSession()"><i class="fa fa-user"></i></span></div></div></div><div class="form-group"><div class="col-sm-8"><div class="box"><div class="box-header"><h2><i class="fa fa-users"></i><span class="break"></span>Selected participants</h2></div><div class="box-content"><table class="table table-striped"><tbody><tr data-ng-repeat="s in vm.session.sessionUsers"><td><h1>{{s.user.fullName}}</h1><p>{{s.user.email}}</p></td><td><button type="button" class="close" aria-hidden="true" data-ng-click="vm.removeParticipant(s)">x</button></td></tr></tbody></table></div></div></div></div><div class="form-group"><div class="col-sm-8"><input type="submit" wz-previous="" class="btn btn-warning pull-left" value="Previous"> <input type="submit" data-ng-click="vm.gotoSummary()" class="btn btn-success pull-right" value="Next"></div></div></div></wz-step><wz-step title="Session Summary" ng-enter-tab="vm.createSession()"><h1>Session summary</h1><hr><div class="form-horizontal"><div class="form-group"><div class="col-sm-8"><div class="alert alert-danger alert-dismissable" data-ng-repeat="error in vm.errors"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">x</button> <span>{{error.errorMessage}}</span></div></div></div><div class="form-group"><div class="col-sm-8"><div class=" box"><div class="box-content"><div class="row"><div class="col-sm-12"><p>Session <strong>{{vm.session.sessionName}}</strong> will start on <strong>{{vm.session.formattedStartDate}}</strong> and will last <strong>{{vm.session.formattedDuration}}</strong>. Each participant will receive a <strong>{{vm.session.vmSize}}</strong> size virtual machine which will be provisioned just before the starting of the session. Connection details will be sent to all selected session participants:</p></div></div><div class="row"><div class="col-sm-12"><ul><li data-ng-repeat="p in vm.session.sessionUsers">{{p.user.fullName}}</li></ul></div></div><div class="row"><div class="col-sm-12"><div class="pull-right"><h1>Estimated session price: <strong>{{vm.estimatedPrice}}&nbsp;<i class="fa fa-eur"></i></strong></h1></div></div></div></div></div><div class="form-group"><input type="submit" wz-previous="" class="btn btn-warning pull-left" value="Previous"> <input type="submit" wz-finish="" class="btn btn-success pull-right" value="Finish"></div></div></div></div></wz-step></wizard></section>')}])}(),function(module){try{module=angular.module("app")}catch(e){module=angular.module("app",[])}module.run(["$templateCache",function($templateCache){$templateCache.put("app/session/sessions.html",'<div class="container" data-ng-controller="sessions as vm"><div class="row"><div class="col-sm-5 col-md-5 "><a href="#/session/new" class="btn btn-success pull-left margin-right"><i class="fa fa-send"></i>&nbsp;Create session</a></div><div class="col-sm-7 col-md-7 hidden-xs"><span class="pull-right margin-right padding"><label class="switch switch-success"><input type="checkbox" class="switch-input" data-ng-model="vm.onlyUpcomingSessions" data-ng-change="vm.setFilter()"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label> <span class="small-font">Upcoming sessions</span></span></div></div><div class="row"><div class="box col-md-4 col-sm-12" data-ng-repeat="s in vm.filteredSessions"><div class="box-header"><h2><i class="fa fa-calendar"></i> <span class="break"></span> {{s.sessionName}}</h2></div><div class="box-content tnList widget-content"><div class="padd"><dl><dt>{{s.formattedStartDateLabel}}:</dt><dd><p>{{s.formattedStartDate}}</p></dd><dt>{{s.formattedDurationLabel}}:</dt><dd><p>{{s.formattedDuration | capitalize}}</p></dd><dt>Lab:</dt><dd><p>{{s.lab.name}}</p></dd></dl><div class="pull-right"><button data-ng-if="!s.isPassed" class="btn btn-success" data-ng-click="vm.gotoSession(s)">Edit</button> <button class="btn btn-warning" data-ng-click="vm.removeSession(s)">Remove</button></div><div class="clearfix"></div></div></div></div></div></div>')}])}(),function(module){try{module=angular.module("app")}catch(e){module=angular.module("app",[])}module.run(["$templateCache",function($templateCache){$templateCache.put("app/user/userdetail.html",'<section data-ng-controller="userdetail as vm"><h1>Please introduce Participant information</h1><hr><div class="form-horizontal"><div class="form-group"><label class="col-sm-2 control-label" for="inputFirstName">First Name</label><div class="col-sm-6"><input id="inputFirstName" class="form-control" name="firstName" data-z-validate="" data-ng-model="vm.user.firstName"></div></div><div class="form-group"><label class="col-sm-2 control-label" for="inputLastName">Last Name</label><div class="col-sm-6"><input id="inputLastName" class="form-control" name="email" data-z-validate="" data-ng-model="vm.user.lastName"></div></div><div class="form-group"><label class=" col-sm-2 control-label" for="inputUserName">User Name</label><div class="col-sm-6"><input type="text" class="form-control" id="inputUserName" name="userName" data-z-validate="" data-ng-model="vm.user.userName"></div></div><div class="form-group"><label class="col-sm-2 control-label" for="inputEmail">Email</label><div class="col-sm-6"><input id="inputEmail" type="text" class="form-control" name="email" data-z-validate="" data-ng-model="vm.user.email"></div></div><div class="form-group"><div class="col-sm-8"><div class="pull-right"><input type="submit" data-ng-click="vm.back()" class="btn btn-warning" value="Back"> <input type="submit" data-ng-click="vm.saveChanges()" class="btn btn-success" value="Save"></div></div></div></div></section>')}])}(),function(module){try{module=angular.module("app")}catch(e){module=angular.module("app",[])}module.run(["$templateCache",function($templateCache){$templateCache.put("app/user/users.html",'<div class="container" data-ng-controller="users as vm"><div class="row"><div class="col-sm-5 col-md-5 "><a href="#/participant/new" class="btn btn-success pull-left margin-right"><i class="fa fa-user"></i>&nbsp;Create new user</a></div></div><div class="row"><div class="box col-md-3 col-sm-4" data-ng-repeat="u in vm.filteredUsers"><div class="box-header"><h2><i class="fa fa-user"></i> <span class="break"></span> &nbsp;{{u.userName}}</h2></div><div class="box-content tnList widget-content"><div class="padd"><dl><dt class="control-label usrtitle">Name:</dt><dd><p>{{u.fullName}}</p></dd><dt class="control-label usrtitle">Email:</dt><dd><p>{{ u.email }}</p></dd></dl><div class="pull-right"><button type="button" class="btn btn-success" data-ng-click="vm.gotoUser(u)">Edit</button> <button class="btn btn-warning" data-ng-click="vm.removeUser(u)">Remove</button></div><div class="clearfix"></div></div></div></div></div></div>')}])}();
!function(){"use strict";var app=angular.module("app",["ngAnimate","ngRoute","ngSanitize","ngCookies","common","ui.bootstrap","breeze.angular","breeze.directives","mgo-angular-wizard"]);app.run(["$route","$rootScope","$q","routemediator",function($route,$rootScope,$q,routemediator){routemediator.setRoutingHandlers()}])}();
!function(){"use strict";var app=angular.module("app");toastr.options.timeOut=4e3,toastr.options.positionClass="toast-bottom-right";var remoteServiceName="breeze/trainings",events={controllerActivateSuccess:"controller.activateSuccess",hasChangesChanged:"datacontext.hasChangesChanged",spinnerToggle:"spinner.toggle",screenResize:"common.resize"},config={appErrorPrefix:"[HT Error] ",docTitle:"Training Labs: ",events:events,remoteServiceName:remoteServiceName,version:"2.0.0"};app.value("config",config),app.config(["$logProvider",function($logProvider){$logProvider.debugEnabled&&$logProvider.debugEnabled(!0)}]),app.config(["commonConfigProvider",function(cfg){cfg.config.controllerActivateSuccessEvent=config.events.controllerActivateSuccess,cfg.config.spinnerToggleEvent=config.events.spinnerToggle,cfg.config.screenResize=config.events.screenResize}]),app.config(["zDirectivesConfigProvider",function(cfg){cfg.zValidateTemplate='<span class="invalid"><i class="icon-warning-sign"></i>Field: %error%</span>',cfg.zRequiredTemplate=""}]),app.filter("capitalize",function(){return function(input){return null!=input&&(input=input.toLowerCase()),input.substring(0,1).toUpperCase()+input.substring(1)}})}();
!function(){"use strict";function extendExceptionHandler($delegate,config,logger){var appErrorPrefix=config.appErrorPrefix,logError=logger.getLogFn("app","error");return function(exception,cause){if($delegate(exception,cause),!appErrorPrefix||0!==exception.message.indexOf(appErrorPrefix)){var errorData={exception:exception,cause:cause},msg=appErrorPrefix+exception.message;logError(msg,errorData,!0)}}}var app=angular.module("app");app.config(["$provide",function($provide){$provide.decorator("$exceptionHandler",["$delegate","config","logger",extendExceptionHandler])}])}();
!function(){"use strict";function routeConfigurator($routeProvider,routes){function setRoute(url,definition){return definition.resolve=angular.extend(definition.resolve||{},{prime:prime}),$routeProvider.when(url,definition),$routeProvider}routes.forEach(function(r){setRoute(r.url,r.config)}),$routeProvider.otherwise({redirectTo:"/"})}function prime(dc){return dc.prime()}function getRoutes(){return[{url:"/",config:{templateUrl:"app/dashboard/dashboard.html",title:"dashboard",settings:{nav:1,content:'<i class="fa fa-dashboard"></i><span class="hidden-sm"> Dashboard</span>'}}},{url:"/labs",config:{title:"Labs",templateUrl:"app/lab/labs.html",settings:{nav:2,content:'<i class="fa fa-laptop"></i><span class="hidden-sm"> Labs</span>'}}},{url:"/sessions",config:{title:"Sessions",templateUrl:"app/session/sessions.html",settings:{nav:3,content:'<i class="fa fa-calendar"></i> <span class="hidden-sm"> Sessions</span>'}}},{url:"/participants",config:{title:"Participants",templateUrl:"app/user/users.html",settings:{nav:4,content:'<i class="fa fa-users"></i> <span class="hidden-sm"> Participants</span>'}}},{url:"/session/:id",config:{title:"Session",templateUrl:"app/session/sessiondetail.html"}},{url:"/lab/:id",config:{title:"Lab detail",templateUrl:"app/lab/labdetail.html"}},{url:"/participant/:id",config:{title:"Participant detail",templateUrl:"app/user/userdetail.html"}}]}var app=angular.module("app");app.constant("routes",getRoutes()),app.config(["$routeProvider","routes",routeConfigurator]),prime.$inject=["datacontext"]}();
!function(){"use strict";function common($q,$rootScope,$timeout,$window,commonConfig,logger){function activateController(promises,controllerId){return $q.all(promises).then(function(){var data={controllerId:controllerId};$broadcast(commonConfig.config.controllerActivateSuccessEvent,data)})}function $broadcast(){return $rootScope.$broadcast.apply($rootScope,arguments)}function createSearchThrottle(viewmodel,list,filteredList,filter,delay){delay=+delay||300,filteredList||(filteredList="filtered"+list[0].toUpperCase()+list.substr(1).toLowerCase(),filter=list+"Filter");var filterFn=function(){viewmodel[filteredList]=viewmodel[list].filter(function(item){return viewmodel[filter](item)})};return function(){var filterInputTimeout;return function(searchNow){filterInputTimeout&&($timeout.cancel(filterInputTimeout),filterInputTimeout=null),searchNow||!delay?filterFn():filterInputTimeout=$timeout(filterFn,delay)}}()}function debouncedThrottle(key,callback,delay,immediate){var defaultDelay=1e3;delay=delay||defaultDelay,throttles[key]&&($timeout.cancel(throttles[key]),throttles[key]=void 0),immediate?callback():throttles[key]=$timeout(callback,delay)}function isNumber(val){return/^[-]?\d+$/.test(val)}function textContains(text,searchText){return text&&-1!==text.toLowerCase().indexOf(searchText.toLowerCase())}function adjustSize(){var w=angular.element($window);resize({h:w.height(),w:w.width()})}function resize(newValue){var winHeight=newValue.h,winWidth=newValue.w,screenSize="large";winHeight&&$("#content").css("min-height",winHeight),980>winWidth&&winWidth>767?(screenSize="small",$(".main-menu-span").hasClass("col-sm-2")&&($(".main-menu-span").removeClass("col-sm-2"),$(".main-menu-span").addClass("col-sm-1")),$("#content").hasClass("col-sm-10")&&($("#content").removeClass("col-sm-10"),$("#content").addClass("col-sm-11"))):($(".main-menu-span").hasClass("col-sm-1")&&($(".main-menu-span").removeClass("col-sm-1"),$(".main-menu-span").addClass("col-sm-2")),$("#content").hasClass("col-sm-11")&&($("#content").removeClass("col-sm-11"),$("#content").addClass("col-sm-10")));var data={size:screenSize,minHeight:winHeight};$broadcast(commonConfig.config.screenResize,data)}function vmCoreNumber(vmSize){switch(vmSize.toLowerCase()){case"small":return 1;case"medium":return 2;case"large":return 4;default:return 1}}function vmPricingHour(vmSize){switch(vmSize.toLowerCase()){case"small":return.056;case"medium":return.112;case"large":return.224;default:return.056}}var throttles={},service={$broadcast:$broadcast,$q:$q,$timeout:$timeout,activateController:activateController,createSearchThrottle:createSearchThrottle,debouncedThrottle:debouncedThrottle,isNumber:isNumber,logger:logger,textContains:textContains,resize:resize,adjustSize:adjustSize,vmCoreNumber:vmCoreNumber,vmPricingHour:vmPricingHour};return service}var commonModule=angular.module("common",[]);commonModule.provider("commonConfig",function(){this.config={},this.$get=function(){return{config:this.config}}}),commonModule.factory("common",["$q","$rootScope","$timeout","$window","commonConfig","logger",common])}();
!function(){"use strict";function logger($log){function getLogFn(moduleId,fnName){switch(fnName=fnName||"log",fnName.toLowerCase()){case"success":fnName="logSuccess";break;case"error":fnName="logError";break;case"warn":fnName="logWarning";break;case"warning":fnName="logWarning"}var logFn=service[fnName]||service.log;return function(msg,data,showToast){showToast=!1,logFn(msg,data,moduleId,void 0===showToast?!0:showToast)}}function log(message,data,source,showToast){logIt(message,data,source,showToast,"info")}function logWarning(message,data,source,showToast){logIt(message,data,source,showToast,"warning")}function logSuccess(message,data,source,showToast){logIt(message,data,source,showToast,"success")}function logError(message,data,source,showToast){logIt(message,data,source,showToast,"error")}function logIt(message,data,source,showToast,toastType){var write="error"===toastType?$log.error:$log.log;source=source?"["+source+"] ":"",write(source,message,data),showToast&&("error"===toastType?toastr.error(message):"warning"===toastType?toastr.warning(message):"success"===toastType?toastr.success(message):toastr.info(message))}var service={getLogFn:getLogFn,log:log,logError:logError,logSuccess:logSuccess,logWarning:logWarning};return service}angular.module("common").factory("logger",["$log",logger])}();
!function(){"use strict";function spinner(common,commonConfig){function spinnerHide(){spinnerToggle(!1)}function spinnerShow(){spinnerToggle(!0)}function spinnerToggle(show){common.$broadcast(commonConfig.config.spinnerToggleEvent,show)}var service={spinnerHide:spinnerHide,spinnerShow:spinnerShow};return service}angular.module("common").factory("spinner",["common","commonConfig",spinner])}();
!function(){"use strict";function dashboard($location,common,datacontext){function activate(){var promises=[getLabsCount(),getSessions(),getSessionsCount(),getLabs(),getNextSession()];common.activateController(promises,controllerId).then(function(){log("Activated Dashboard View")})}function getNextSession(){return datacontext.session.getFirstByDate().then(function(data){return vm.nextSession=data[0],void 0!==vm.nextSession&&vm.nextSession.entityAspect.loadNavigationProperty("sessionUsers"),vm.nextSession})}function getLabsCount(){return datacontext.lab.getCount().then(function(data){return vm.labsCount=data})}function getSessionsCount(){return datacontext.session.getCount().then(function(data){return vm.sessionsCount=data})}function getSessions(){return vm.sessions=datacontext.session.getUpcomingThreeSessions()}function getLabs(){return vm.labs=datacontext.lab.getLatestThreeLabs()}function gotoLab(lab){lab&&lab.labId&&$location.path("/lab/"+lab.labId)}function gotoSession(session){session&&session.sessionId&&$location.path("/session/"+session.sessionId)}var getLogFn=common.logger.getLogFn,log=getLogFn(controllerId),vm=this;vm.news={title:"Labs",description:"Training labs."},vm.gotoLab=gotoLab,vm.gotoSession=gotoSession,vm.labsCount=0,vm.sessionsCount=0,vm.sessions=[],vm.labs=[],vm.nextSession=void 0,vm.title="Labs",activate()}var controllerId="dashboard";angular.module("app").controller(controllerId,["$location","common","datacontext",dashboard])}();
!function(){"use strict";function createLab($cookies,$location,$routeParams,$scope,$window,common,config,datacontext,spinner,vmManagement,WizardHandler){function activate(){onDestroy(),common.activateController([initLab()],controllerId)}function createTemplateImage(){function createSuccess(){spinner.spinnerHide(),$window.history.back()}function createError(){spinner.spinnerHide()}var selectedChocoPackagesString="";for(var option in vm.selectedChocoPackages)vm.selectedChocoPackages[option]&&(selectedChocoPackagesString+=""==selectedChocoPackagesString?option:","+option);return vmManagement.createVmForBaseImage(vm.lab.imageName,vm.lab.description,vm.lab.name,selectedChocoPackagesString).success(createSuccess).error(createError)}function initLab(){function gotoLabs(){$location.path("/labs")}var val=$routeParams.id;return"new"===val?void(vm.lab=datacontext.lab.create()):(vm.isNew=!1,void datacontext.lab.getById(val).then(function(data){vm.lab=data},function(){logError("Unable to get lab "+val),gotoLabs()}))}function internalCreateLab(){function saveSucceded(){spinner.spinnerHide(),$window.history.back()}function saveFailed(){spinner.spinnerHide()}if(isValid(vm.lab))if(spinner.spinnerShow(),vm.createTemplateImage)datacontext.cancel(),createTemplateImage();else{var subscription=$cookies.subscription;vm.lab.subscriptionId=subscription,vm.lab.creationDate=moment().toDate(),datacontext.saveChanges().then(saveSucceded,saveFailed)}}function isValid(lab){var aspect=lab.entityAspect;return!aspect.validateEntity()&&(vm.errors=aspect.getValidationErrors("imageName"),vm.errors.length>0)?(vm.errors[0].errorMessage="Please select an template image",!1):!0}function nextStep(){var aspect=vm.lab.entityAspect;(aspect.validateProperty("name")||aspect.validateProperty("description"))&&WizardHandler.wizard().next()}function onDestroy(){$scope.$on("$destroy",function(){datacontext.cancel()})}{var vm=this,getLogFn=common.logger.getLogFn;getLogFn(controllerId)}vm.availableCustomImages=datacontext.availableVmImages,vm.availableChocoPackages=datacontext.availableChocoPackages,vm.selectedChocoPackages={},vm.createLab=internalCreateLab,vm.createTemplateImage=!1,vm.isNew=!0,vm.nextStep=nextStep,vm.errors=[],vm.lab=void 0,activate()}var controllerId="labdetail";angular.module("app").controller(controllerId,["$cookies","$location","$routeParams","$scope","$window","common","config","datacontext","spinner","vm.management","WizardHandler",createLab])}();
!function(){"use strict";function labs($location,$routeParams,common,config,datacontext){function activate(){common.activateController([getLabs()],controllerId).then(function(){log("Activated Labs View")})}function getLabs(forceRefresh){return datacontext.lab.getAll(forceRefresh).then(function(data){return vm.filteredLabs=data})}function gotoLab(lab){lab&&lab.labId&&$location.path("/lab/"+lab.labId)}function removeLab(lab){lab.removed=!0,datacontext.saveChanges(),getLabs(!1)}var vm=this,getLogFn=common.logger.getLogFn,log=getLogFn(controllerId);vm.filteredLabs=[],vm.title="Labs",vm.gotoLab=gotoLab,vm.removeLab=removeLab,activate()}var controllerId="labs";angular.module("app").controller(controllerId,["$location","$routeParams","common","config","datacontext",labs])}();
!function(){"use strict";function shell($rootScope,$scope,$window,common,config,datacontext){function activate(){logSuccess("Training Labs loaded!",null,!0),common.activateController([getVersion()],controllerId).then(function(){})}function getVersion(){return datacontext.getVersion().then(function(data){return vm.version=data})}function toggleSpinner(on){vm.isBusy=on}var vm=this,logSuccess=common.logger.getLogFn(controllerId,"success"),events=config.events;vm.busyMessage="Please wait ...",vm.isBusy=!0,vm.size=void 0,vm.year=moment().year(),vm.version=void 0,vm.height=function(){return{"min-height":vm.minHeight+"px"}},vm.minHeight=void 0,vm.spinnerOptions={radius:40,lines:7,length:0,width:30,speed:1.7,corners:1,trail:100,color:"#F58A00"},activate(),$rootScope.$on("$routeChangeStart",function(){toggleSpinner(!0)}),$rootScope.$on("$routeChangeSuccess",function(){toggleSpinner(!1)}),$rootScope.$on(events.screenResize,function(data,screenResize){vm.size=screenResize.size,vm.minHeight=screenResize.minHeight}),$rootScope.$on(events.spinnerToggle,function(data,show){toggleSpinner(show)})}var controllerId="shell";angular.module("app").controller(controllerId,["$rootScope","$scope","$window","common","config","datacontext",shell])}();
!function(){"use strict";function sidebar($route,config,routes){function activate(){getNavRoutes()}function getNavRoutes(){vm.navRoutes=routes.filter(function(r){return r.config.settings&&r.config.settings.nav}).sort(function(r1,r2){return r1.config.settings.nav-r2.config.settings.nav})}function isCurrent(route){if(!route.config.title||!$route.current||!$route.current.title)return"";var menuName=route.config.title;return $route.current.title.substr(0,menuName.length)===menuName?"active":""}var vm=this;vm.isCurrent=isCurrent,activate()}var controllerId="sidebar";angular.module("app").controller(controllerId,["$route","config","routes",sidebar])}();
!function(){"use strict";function topnav($route,config,common,datacontext){function activate(){common.activateController([getSubscriptions()],controllerId).then(function(){log("Activated Subscriptions View")})}function getSubscriptions(){return datacontext.getAvailableSubscriptions().then(function(data){return vm.subscriptions=data})}function changeSubscription(){}function currentStyle(isCurrent){return isCurrent?"fa-check active":""}var vm=this,getLogFn=common.logger.getLogFn,log=getLogFn(controllerId);vm.changeSubscription=changeSubscription,vm.currentStyle=currentStyle,vm.subscriptions=[],activate()}var controllerId="topnav";angular.module("app").controller(controllerId,["$route","config","common","datacontext",topnav])}();
!function(){"use strict";function datacontext(common,emFactory,model,repositories){function init(){repositories.init(manager),defineLazyLoadedRepos(),getAvailableVmImages(),getAvailableChocoPackages(),getAvailableSubscriptions(),setupEventForHasChangesChanged()}function cancel(){manager.hasChanges()&&(manager.rejectChanges(),logSuccess("Canceled changes",null,!0))}function getVersion(forceRemote){var self=this;return void 0===version||forceRemote?breeze.EntityQuery.from("Version").using(manager).execute().then(getVersionSucceeded):self.$q.then(version)}function getAvailableVmImages(){return breeze.EntityQuery.from("AvailableTemplateImages").using(manager).execute().then(getAvailableVmImagesSucceeded)}function getAvailableChocoPackages(){return breeze.EntityQuery.from("AvailableChocoPackages").using(manager).execute().then(getAvailableChocoPackagesSucceeded)}function getAvailableSubscriptions(){return breeze.EntityQuery.from("AvailableSubscriptions").using(manager).execute().then(getAvailableSubscriptionsSucceeded)}function getAvailableSubscriptionResources(sessionStartDate,sessionEndDate){return breeze.EntityQuery.from("CheckForAvailableResources").withParameters({sessionStart:moment(sessionStartDate).format(),sessionEnd:moment(sessionEndDate).format()}).using(manager).execute().then(getAvailableSubscriptionsResourcesSucceeded)}function getVersionSucceeded(data){return version=data.results[0],log("Retrieved version"+service.version+"from remote data source",null,!0),version}function getAvailableVmImagesSucceeded(data){service.availableVmImages=data.results,log("Retrieved [VM Images] from remote data source",service.availableVmImages.length,!0)}function getAvailableChocoPackagesSucceeded(data){service.availableChocoPackages=data.results,log("Retrieved [Application packages] from remote data source",service.availableChocoPackages.length,!0)}function getAvailableSubscriptionsSucceeded(data){return service.availableSubscriptions=data.results,log("Retrieved [Available subscriptions] from remote data source",service.availableSubscriptions.length,!0),service.availableSubscriptions}function getAvailableSubscriptionsResourcesSucceeded(data){return service.availableSubscriptionResources=data.results,log("Retrieved [Available subscriptions] from remote data source",service.availableSubscriptionResources.length,!0),service.availableSubscriptionResources}function defineLazyLoadedRepos(){repoNames.forEach(function(name){Object.defineProperty(service,name,{configurable:!0,get:function(){var repo=repositories.getRepo(name);return Object.defineProperty(service,name,{value:repo,configurable:!1,enumerable:!0}),repo}})})}function prime(){function success(){log("Primed the data")}function extendMetadata(){function set(resourceName,entityName){metadataStore.setEntityTypeForResourceName(resourceName,entityName)}var metadataStore=manager.metadataStore;model.extendMetadata(metadataStore);var types=metadataStore.getEntityTypes();types.forEach(function(type){type instanceof breeze.EntityType&&set(type.shortName,type)})}return primePromise?primePromise:primePromise=$q.all([getVersion(!0),service.lab.getAll(!0),service.session.getAll(!0),getAvailableVmImages(),getAvailableChocoPackages(),getAvailableSubscriptions(),service.sessionuser.getAll(!0)]).then(extendMetadata).then(success)}function saveChanges(){return manager.saveChanges().then(saveSucceded)}function saveSucceded(){log("All changes where saved","",!0)}function setupEventForHasChangesChanged(){manager.hasChangesChanged.subscribe(function(eventArgs){var data={hasChanges:eventArgs.hasChanges};common.$broadcast(events.hasChangesChanged,data)})}function deleteEntity(entity){entity.entityAspect.setDeleted(),saveChanges()}function deleteEntityNoSave(entity){entity.entityAspect.setDeleted()}var primePromise,getLogFn=(model.entityNames,common.logger.getLogFn),log=getLogFn(serviceId),logSuccess=(getLogFn(serviceId,"error"),getLogFn(serviceId,"success")),manager=emFactory.newManager(),repoNames=["lab","session","sessionuser","user"],$q=common.$q,version=void 0,service={cancel:cancel,deleteEntityNoSave:deleteEntityNoSave,deleteEntity:deleteEntity,saveChanges:saveChanges,prime:prime,availableVmImages:[],availableChocoPackages:[],getVersion:getVersion,getAvailableSubscriptions:getAvailableSubscriptions,getAvailableSubscriptionResources:getAvailableSubscriptionResources};return init(),service}var serviceId="datacontext";angular.module("app").factory(serviceId,["common","entityManagerFactory","model","repositories","spinner",datacontext])}();
!function(){"use strict";var app=angular.module("app");app.directive("resizable",function($window,common){function link(scope){var w=angular.element($window);scope.getWindowDimensions=function(){return{h:w.height(),w:w.width()}},scope.$watch(scope.getWindowDimensions,common.resize,!0),w.bind("resize",function(){scope.$apply()}),common.resize({h:w.height(),w:w.width()})}var directive={link:link,restrict:"A"};return directive}),app.directive("ccWidgetClose",function(){function link(scope,element,attrs){function close(e){e.preventDefault(),element.parent().parent().parent().hide(100)}attrs.$set("href","#"),attrs.$set("wclose"),element.click(close)}var directive={link:link,template:'<i class="fa fa-times"></i>',restrict:"A"};return directive}),app.directive("ccWidgetMinimize",function(){function link(scope,element,attrs){function minimize(e){e.preventDefault();var $wcontent=element.parent().parent().next(".widget-content"),iElement=element.children("i");$wcontent.is(":visible")?(iElement.removeClass("fa fa-chevron-up"),iElement.addClass("fa fa-chevron-down"),$wcontent.fadeOut(500)):(iElement.removeClass("fa fa-chevron-down"),iElement.addClass("fa fa-chevron-up"),$wcontent.fadeIn(500))}attrs.$set("href","#"),attrs.$set("wminimize"),element.click(minimize)}var directive={link:link,template:'<i class="fa fa-chevron-up"></i>',restrict:"A"};return directive}),app.directive("stepScrollToTop",function(){function link(scope,element){element.find("input[value='Next']").click(function(e){e.preventDefault(),$("body").animate({scrollTop:0},500)}),element.find("input[value='Previous']").click(function(e){e.preventDefault(),$("body").animate({scrollTop:0},500)})}var directive={link:link,restrict:"A"};return directive}),app.directive("ccScrollToTop",["$window",function($window){function link(scope,element){function toggleIcon(){$win.scrollTop()>300?element.slideDown():element.slideUp()}var $win=$($window);element.addClass("totop"),$win.scroll(toggleIcon),element.find("a").click(function(e){e.preventDefault(),$("body").animate({scrollTop:0},500)})}var directive={link:link,template:'<a href="#"><i class="fa fa-chevron-up"></i></a>',restrict:"A"};return directive}]),app.directive("ccSpinner",["$window",function($window){function link(scope,element,attrs){scope.spinner=null,scope.$watch(attrs.ccSpinner,function(options){scope.spinner&&scope.spinner.stop(),scope.spinner=new $window.Spinner(options),scope.spinner.spin(element[0])},!0)}var directive={link:link,restrict:"A"};return directive}]),app.directive("ccWidgetHeader",function(){function link(scope,element,attrs){attrs.$set("class","box-header")}var directive={link:link,scope:{title:"@",subtitle:"@",rightText:"@",allowCollapse:"@"},templateUrl:"/app/layout/widgetheader.html",restrict:"A"};return directive}),app.directive("datePicker",function(){function link(scope,element){element.datepicker({format:"dd MM yyyy",startDate:"today",todayBtn:"linked",autoclose:!0,todayHighlight:!0})}var directive={link:link,restrict:"A"};return directive}),app.directive("moDateInput",function($window){return{require:"^ngModel",restrict:"A",link:function(scope,elm,attrs,ctrl){var moment=$window.moment,dateFormat=attrs.moDateInput;attrs.$observe("moDateInput",function(newValue){dateFormat!=newValue&&ctrl.$modelValue&&(dateFormat=newValue,ctrl.$modelValue=new Date(ctrl.$setViewValue))}),ctrl.$formatters.unshift(function(modelValue){if(scope=scope,!dateFormat||!modelValue)return"";var retVal=moment(modelValue).format(dateFormat);return retVal}),ctrl.$parsers.unshift(function(viewValue){scope=scope;var date=moment(viewValue,dateFormat);return date&&date.isValid()&&date.year()>1950?date.toDate():""})}}}),app.directive("editOnLoad",function($timeout){return{restrict:"A",link:function(scope,element,attrs){if(0==attrs.index&&""==attrs.email){var run=function(){element.find("button.btn-danger")[0].click()};$timeout(function(){run()},10)}}}}),app.directive("timePicker",function(){function link(scope,element){element.timepicker({defaultTime:!1,showMeridian:!1})}var directive={link:link,restrict:"A"};return directive}),app.directive("ngEnterTab",function(){return function(scope,element,attrs){element.bind("keydown keypress",function(event){(13===event.which||9===event.which)&&(scope.$apply(function(){scope.$eval(attrs.ngEnterTab)}),event.preventDefault())})}})}();
!function(){"use strict";function emFactory(breeze,config,model){function createMetadataStore(){var store=new breeze.MetadataStore;return model.configureMetadataStore(store),store}function newManager(){var mgr=new breeze.EntityManager({serviceName:serviceName,metadataStore:metadataStore});return mgr}breeze.NamingConvention.camelCase.setAsDefault(),new breeze.ValidationOptions({validateOnAttach:!1}).setAsDefault();var serviceName=config.remoteServiceName,metadataStore=createMetadataStore(),provider={metadataStore:metadataStore,newManager:newManager};return provider}var serviceId="entityManagerFactory";angular.module("app").factory(serviceId,["breeze","config","model",emFactory])}();
!function(){"use strict";function model(modelValidation){function configureMetadataStore(metadataStore){registerLab(metadataStore),registerSession(metadataStore),registerSessionUser(metadataStore),registerUser(metadataStore),modelValidation.createAndRegister(entityNames)}function extendMetadata(metadataStore){modelValidation.applyValidators(metadataStore)}function registerLab(metadataStore){function Lab(){}metadataStore.registerEntityTypeCtor("Lab",Lab)}function registerSession(metadataStore){function Session(){}metadataStore.registerEntityTypeCtor("Session",Session),Object.defineProperty(Session.prototype,"date",{get:function(){return this.startDate},set:function(value){var date=moment(value),mStartDate=moment(this.startDate).day(date.day()).month(date.month()).year(date.year()),mEndDate=moment(this.endDate).day(date.day()).month(date.month()).year(date.year());this.startDate=mStartDate.toDate(),this.endDate=mEndDate.toDate()}}),Object.defineProperty(Session.prototype,"startTime",{get:function(){return moment(this.startDate).format("HH:mm")},set:function(value){var sTime=moment(value,"hh:mm"),mStartDate=moment(this.startDate).hour(sTime.hour()).minute(sTime.minute());this.startDate=mStartDate.toDate()}}),Object.defineProperty(Session.prototype,"endTime",{get:function(){return moment(this.endDate).format("HH:mm")},set:function(value){var eTime=moment(value,"hh:mm"),mEndDate=moment(this.startDate).hour(eTime.hour()).minute(eTime.minute()),sDate=moment(this.startDate);sDate.isAfter(mEndDate)||(this.endDate=mEndDate.toDate())}}),Object.defineProperty(Session.prototype,"duration",{get:function(){return moment(this.endDate).diff(moment(this.startDate),"minutes")}}),Object.defineProperty(Session.prototype,"isPassed",{get:function(){return moment().isAfter(this.startDate)}}),Object.defineProperty(Session.prototype,"formattedStartDateLabel",{get:function(){return this.isPassed?"Session has started in":"Session will start in"}}),Object.defineProperty(Session.prototype,"formattedDurationLabel",{get:function(){return this.isPassed?"Session has lasted":"Session will last"}}),Object.defineProperty(Session.prototype,"formattedStartDate",{get:function(){return moment(this.startDate).format("Do MMMM YYYY")+" at "+moment(this.startDate).format("HH:mm")}}),Object.defineProperty(Session.prototype,"formattedDuration",{get:function(){var duration=moment.duration(this.duration,"minutes"),hours=duration.hours(),minutes=duration.minutes(),formattedDuration="";return hours>0&&(formattedDuration=moment.duration(hours,"hours").humanize()),minutes>0&&(formattedDuration.length>0&&(formattedDuration+=" and "),formattedDuration+=moment.duration(minutes,"minutes").humanize()),formattedDuration}})}function registerSessionUser(metadataStore){function SessionUser(){}metadataStore.registerEntityTypeCtor("SessionUser",SessionUser)}function registerUser(metadataStore){function User(){}metadataStore.registerEntityTypeCtor("User",User),Object.defineProperty(User.prototype,"fullName",{get:function(){var fn=this.firstName,ln=this.lastName;return ln?fn+" "+ln:fn}})}var entityNames={lab:"Lab",session:"Session",sessionUser:"SessionUser",user:"User"},service={configureMetadataStore:configureMetadataStore,entityNames:entityNames,extendMetadata:extendMetadata};return service}var serviceId="model";angular.module("app").factory(serviceId,["model.validation",model])}();
!function(){"use strict";function modelValidation(common){function applyValidators(metadataStore){applyLabRequireReferenceValidators(metadataStore),applySessionRequireReferenceValidators(metadataStore),applyUserRequireReferenceValidators(metadataStore),log("Validators applied",null,serviceId)}function applyUserRequireReferenceValidators(metadataStore){var navigations=["email","firstName","lastName"],entityType=metadataStore.getEntityType(entityNames.user);navigations.forEach(function(propertyName){entityType.getProperty(propertyName).validators.push(requireReferenceValidator)}),entityType.getProperty("email").validators.push(emailValidator)}function applyLabRequireReferenceValidators(metadataStore){var navigations=["description"],entityType=metadataStore.getEntityType(entityNames.lab);navigations.forEach(function(propertyName){entityType.getProperty(propertyName).validators.push(requireReferenceValidator)})}function applySessionRequireReferenceValidators(metadataStore){var navigations=["lab"],entityType=metadataStore.getEntityType(entityNames.session);navigations.forEach(function(propertyName){var property=entityType.getProperty(propertyName);property.validators.push(requireReferenceValidator)}),entityType.getProperty("startDate").validators.push(requireDateReferenceValidator)}function createAndRegister(eNames){entityNames=eNames,requireReferenceValidator=createRequireReferenceValidator(),requireDateReferenceValidator=createDateRequireReferenceValidator(),endTimeValidator=createEndTimeValidator(),emailValidator=createEmailValidator(),Validator.register(requireReferenceValidator),Validator.register(requireDateReferenceValidator),log("Validators created and registered",null,serviceId,!1)}function createEmailValidator(){return breeze.Validator.makeRegExpValidator("emailAddress",/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/,"The %displayName% is not a valid email address")}function createRequireReferenceValidator(){function valFunction(value){return value?0!==value.id:!1}var name="requireReferenceEntity",ctx={messageTemplate:"Missing %displayName%",isRequired:!0},val=new Validator(name,valFunction,ctx);return val}function createDateRequireReferenceValidator(){function valFunction(value){var mValue=moment(value),mDefaultValue=moment(new Date(1900,0,1));return value?!mValue.isSame(mDefaultValue):!1}var name="requireDateReferenceEntity",ctx={messageTemplate:"Missing %displayName%",isRequired:!0},val=new Validator(name,valFunction,ctx);return val}function createEndTimeValidator(){function valFunction(value,context){var endTime=moment(value,"hh:mm"),startTime=moment(context.entity.startTime,"hh:mm");return endTime.isValid()&&startTime.isValid()?startTime.isAfter(endTime)||startTime.isSame(endTime)?!1:!0:!1}var name="endTimeValidator",ctx={messageTemplate:"Must be greater than start time",isRequired:!1},val=new Validator(name,valFunction,ctx);return val}var entityNames,requireReferenceValidator,requireDateReferenceValidator,emailValidator,endTimeValidator,log=common.logger.getLogFn(serviceId),Validator=breeze.Validator,service={applyValidators:applyValidators,createAndRegister:createAndRegister};return service}var serviceId="model.validation";angular.module("app").factory(serviceId,["common",modelValidation])}();
!function(){"use strict";function repositories($injector){function init(mgr){manager=mgr}function getRepo(repoName){var fullRepoName="repository."+repoName.toLowerCase(),Repo=$injector.get(fullRepoName);return new Repo(manager)}var manager,service={getRepo:getRepo,init:init};return service}var serviceId="repositories";angular.module("app").factory(serviceId,["$injector",repositories])}();
!function(){"use strict";function AbstractRepositry(common){function Ctor(){this.isLoaded=!1}function _areItemsLoaded(value){return void 0===value?this.isLoaded:this.isLoaded=value}function _getAllLocal(resource,ordering,predicate){return EntityQuery.from(resource).orderBy(ordering).where(predicate).using(this.manager).executeLocally()}function _getAllLocalWithTake(resource,ordering,predicate,take){return EntityQuery.from(resource).orderBy(ordering).take(take).where(predicate).using(this.manager).executeLocally()}function _getById(entityName,id,forceRemote){function querySucceeded(data){return(entity=data.entity)?(self.log("Retrieved ["+entityName+"] id "+entity.id+" from remote data source",entity,!0),entity):(self.log("Could not find ["+entityName+"] id:"+id,null,!0),null)}var self=this,manager=self.manager;if(!forceRemote){var entity=manager.getEntityByKey(entityName,id);if(entity&&!entity.isPartial)return self.log("Retrieved ["+entityName+"] id:"+id+" from cache.",entity,!0),entity.entityAspect.entityState.isDeleted()&&(entity=null),$q.when(entity)}return manager.fetchEntityByKey(entityName,id).then(querySucceeded,self._queryFailed)}function _getFirstByDate(entityName,orderBy){function querySucceeded(data){var entity=data.results;return entity}return this._areItemsLoaded()?$q.when(this._getLocalFirstBy(entityName,orderBy)):EntityQuery.from(entityName).orderBy(orderBy).take(1).using(manager).execute().then(querySucceeded)}function _getInlineCount(data){return data.inlineCount}function _getLocalEntityCount(resource,predicate){var entities=EntityQuery.from(resource).where(predicate).using(this.manager).executeLocally();return entities.length}function _getLocalFirstBy(entityName,orderBy,predicate){var entities=EntityQuery.from(entityName).where(predicate).orderBy(orderBy).take(1).using(this.manager).executeLocally();return entities}function _queryFailed(error){throw error}var EntityQuery=(breeze.Predicate,breeze.EntityQuery),$q=common.$q;return Ctor.extend=function(repoCtor){repoCtor.prototype=new Ctor,repoCtor.prototype.constructor=repoCtor},Ctor.prototype._areItemsLoaded=_areItemsLoaded,Ctor.prototype._getAllLocal=_getAllLocal,Ctor.prototype._getAllLocalWithTake=_getAllLocalWithTake,Ctor.prototype._getById=_getById,Ctor.prototype._getFirstByDate=_getFirstByDate,Ctor.prototype._getInlineCount=_getInlineCount,Ctor.prototype._getLocalEntityCount=_getLocalEntityCount,Ctor.prototype._getLocalFirstBy=_getLocalFirstBy,Ctor.prototype._queryFailed=_queryFailed,Ctor.prototype.log=common.logger.getLogFn(this.serviceId),Ctor.prototype.$q=common.$q,Ctor}var serviceId="repository.abstract";angular.module("app").factory(serviceId,["common","config",AbstractRepositry])}();
!function(){"use strict";function RepositoryLab(model,AbstractRepository){function Ctor(mgr){this.serviceId=serviceId,this.entityName=entityName,this.manager=mgr,this.create=create,this.getAll=getAll,this.getById=getById,this.getCount=getCount,this.getLatestThreeLabs=getLatestThreeLabs}function create(){return this.manager.createEntity(entityName)}function getAll(forceRemote){function querySucceeded(data){return labs=data.results,self._areItemsLoaded(!0),self.log("Retrieved [Labs] from remote data source",labs.length,!0),labs}var labs,self=this,orderBy="creationDate desc",predicate=Predicate.create("removed","==",0);return self._areItemsLoaded()&&!forceRemote?(labs=self._getAllLocal(entityName,orderBy,predicate),self.$q.when(labs)):EntityQuery.from("Labs").select("labId, name, imageName, description, creationDate, removed").where("removed","==","0").orderBy(orderBy).toType(entityName).using(self.manager).execute().then(querySucceeded,self._queryFailed)}function getLatestThreeLabs(){var self=this,orderBy="creationDate desc";return self._getAllLocalWithTake(entityName,orderBy,void 0,3)}function getById(id,forceRemote){return this._getById(entityName,id,forceRemote)}function getCount(){var self=this;return self._areItemsLoaded()?self.$q.when(self._getLocalEntityCount(entityName)):EntityQuery.from("Labs").take(0).inlineCount().using(self.manager).execute().then(self._getInlineCount)}var entityName=model.entityNames.lab,Predicate=breeze.Predicate,EntityQuery=breeze.EntityQuery;return AbstractRepository.extend(Ctor),Ctor}var serviceId="repository.lab";angular.module("app").factory(serviceId,["model","repository.abstract",RepositoryLab])}();
!function(){"use strict";function repository(model,AbstractRepository){function Ctor(mgr){this.serviceId=serviceId,this.entityName=entityName,this.manager=mgr,this.create=create,this.getAll=getAll,this.getById=getById,this.getCount=getCount,this.getFirstByDate=getFirstByDate,this.getParticipant=getParticipant,this.getUpcomingThreeSessions=getUpcomingThreeSessions,this.isParticipantInSession=isParticipantInSession,this.removeParticipant=removeParticipant}function _notRemovedPredicate(){return Predicate.create("removed","==",0)}function create(initialValues){return this.manager.createEntity(entityName,initialValues)}function getAll(forceRemote){function querySucceeded(data){return sessions=data.results,self._areItemsLoaded(!0),self.log("Retrieved [Sessions] from remote data source",sessions.length,!0),sessions}self=this;var sessions,orderBy="startDate desc";return self._areItemsLoaded()&&!forceRemote?(sessions=self._getAllLocal(entityName,orderBy,_notRemovedPredicate()),self.$q.when(sessions)):EntityQuery.from("Sessions").where(_notRemovedPredicate()).orderBy(orderBy).expand("Lab").toType(entityName).using(self.manager).execute().then(querySucceeded,self._queryFailed)}function getById(id,forceRemote){return this._getById(entityName,id,forceRemote)}function getCount(){return self=this,self._areItemsLoaded()?self.$q.when(self._getLocalEntityCount(entityName,_notRemovedPredicate())):EntityQuery.from("Sessions").where(_notRemovedPredicate()).take(0).inlineCount().using(self.manager).execute().then(self._getInlineCount)}function getFirstByDate(){self=this;var orderBy="startDate desc";return self._getFirstByDate("Sessions",orderBy)}function getParticipant(session,participant){function _participantPredicate(filterValue){return Predicate.create("userId","==",filterValue)}function _sessionPredicate(filterValue){return Predicate.create("sessionId","==",filterValue)}void 0===self&&(self=this);var orderBy="user.email",predicate=Predicate.and([_sessionPredicate(session.sessionId),_participantPredicate(participant.userId)]),participants=self._getAllLocal(model.entityNames.sessionUser,orderBy,predicate);return void 0!==participants&&null!=participants&&1==participants.length?participants[0]:void 0}function getUpcomingThreeSessions(){function _upcomingThreeSessionsPredicate(){return Predicate.create("startDate",">=",moment().toDate())}self=this;var orderBy="startDate",predicate=Predicate.and([_notRemovedPredicate(),_upcomingThreeSessionsPredicate()]);return self._getAllLocalWithTake(entityName,orderBy,predicate,3)}function isParticipantInSession(session,participant){self=this;var sessionParticipant=getParticipant(session,participant);return void 0!==sessionParticipant}function removeParticipant(session,participant){var internalParticipant=getParticipant(session,participant);void 0!==internalParticipant&&internalParticipant.entityAspect.setDeleted()}var entityName=model.entityNames.session,EntityQuery=breeze.EntityQuery,Predicate=breeze.Predicate,self=void 0;return AbstractRepository.extend(Ctor),Ctor}var serviceId="repository.session";angular.module("app").factory(serviceId,["model","repository.abstract",repository])}();
!function(){"use strict";function repository(model,AbstractRepository){function Ctor(mgr){this.serviceId=serviceId,this.entityName=entityName,this.manager=mgr,this.getAll=getAll,this.create=create}function create(initialValues){return this.manager.createEntity(entityName,initialValues)}function getAll(forceRemote,sessionId){function querySucceeded(data){return sessionUsers=data.results,self._areItemsLoaded(!0),self.log("Retrieved [Session Participants] from remote data source",sessionUsers.length,!0),sessionUsers}function _sessionPredicate(filterValue){return Predicate.create("sessionId","==",filterValue)}var sessionUsers,self=this,orderBy="user.email",predicate=void 0;return void 0!==sessionId&&(predicate=_sessionPredicate(sessionId)),self._areItemsLoaded()&&!forceRemote?(sessionUsers=self._getAllLocal(entityName,orderBy,predicate),self.$q.when(sessionUsers)):EntityQuery.from("SessionUsers").orderBy(orderBy).where(predicate).expand("User").toType(entityName).using(self.manager).execute().then(querySucceeded,self._queryFailed)}var entityName=model.entityNames.sessionUser,Predicate=breeze.Predicate,EntityQuery=breeze.EntityQuery;return AbstractRepository.extend(Ctor),Ctor}var serviceId="repository.sessionuser";angular.module("app").factory(serviceId,["model","repository.abstract",repository])}();
!function(){"use strict";function repository(model,AbstractRepository){function Ctor(mgr){this.serviceId=serviceId,this.entityName=entityName,this.manager=mgr,this.getAll=getAll,this.getById=getById,this.create=create}function create(){return this.manager.createEntity(entityName)}function getById(id,forceRemote){return this._getById(entityName,id,forceRemote)}function getAll(forceRemote){function querySucceeded(data){return users=data.results,self._areItemsLoaded(!0),self.log("Retrieved [Users] from remote data source",users.length,!0),users}var users,self=this,orderBy="email",predicate=Predicate.create("removed","==",0);return self._areItemsLoaded()&&!forceRemote?(users=self._getAllLocal(entityName,orderBy,predicate),self.$q.when(users)):EntityQuery.from("Users").where("removed","==","0").orderBy(orderBy).toType(entityName).using(self.manager).execute().then(querySucceeded,self._queryFailed)}var entityName=model.entityNames.user,EntityQuery=breeze.EntityQuery,Predicate=breeze.Predicate;return AbstractRepository.extend(Ctor),Ctor}var serviceId="repository.user";angular.module("app").factory(serviceId,["model","repository.abstract",repository])}();
!function(){"use strict";function routemediator($location,$rootScope,config,logger){function setRoutingHandlers(){updateDocTitle(),handleRoutingErrors()}function handleRoutingErrors(){$rootScope.$on("$routeChangeError",function(event,current,previous,rejection){if(!handleRouteChangeError){handleRouteChangeError=!0;var msg="Error routing: "+(current&&current.name)+". "+(rejection.msg||"");logger.logWarning(msg,current,serviceId,!0),$location.path("/")}})}function updateDocTitle(){$rootScope.$on("$routeChangeSuccess",function(event,current){handleRouteChangeError=!1;var title=config.docTitle+" "+(current.title||"");$rootScope.title=title})}var handleRouteChangeError=!1,service={setRoutingHandlers:setRoutingHandlers};return service}var serviceId="routemediator";angular.module("app").factory(serviceId,["$location","$rootScope","config","logger",routemediator])}();
!function(){"use strict";function vmManagement($http){function createVmForBaseImage(imageName,imageDescription,newImageName,chocoPackages){return $http.get("api/azuremanagement/CreateBaseVmImage?imageName="+encodeURIComponent(imageName)+"&imageDescription="+encodeURIComponent(imageDescription)+"&newImageName="+encodeURIComponent(newImageName)+"&chocoPackages="+encodeURIComponent(chocoPackages))}var service={createVmForBaseImage:createVmForBaseImage};return service}var serviceId="vm.management";angular.module("app").factory(serviceId,["$http",vmManagement])}();
!function(){"use strict";function sessions($cookies,$scope,$routeParams,$window,common,config,datacontext,spinner,WizardHandler){function activate(){onDestroy(),common.activateController([initSession(),getLabs(),getParticipants()],controllerId),$scope.$on("wizard:stepChanged",function(){vm.errors=[]})}function addParticipantToSession(){void 0!==vm.selectedParticipant&&("string"==typeof vm.selectedParticipant||datacontext.session.isParticipantInSession(vm.session,vm.selectedParticipant)||(datacontext.sessionuser.create({user:vm.selectedParticipant,session:vm.session}),vm.selectedParticipant=void 0))}function createSession(){function saveSucceded(){spinner.spinnerHide(),$window.history.back()}function saveFailed(error){logError("Unable to create session "+error),spinner.spinnerHide()}spinner.spinnerShow();var subscription=$cookies.subscription;vm.session.subscriptionId=subscription,datacontext.saveChanges().then(saveSucceded,saveFailed)}function initSession(){function gotoSessions(){$location.path("/sessions")}var val=$routeParams.id;if("new"===val){vm.isNew=!0;var sDate=moment().add(1,"hours").minutes(0).seconds(0),eDate=moment().add(2,"hours").minutes(0).seconds(0);return void(vm.session=datacontext.session.create({startDate:sDate.toDate(),endDate:eDate.toDate(),vmSize:"Small"}))}vm.isNew=!1,datacontext.session.getById(val).then(function(data){vm.session=data,vm.session.entityAspect.loadNavigationProperty("sessionUsers"),vm.originalNumberOfUsers=vm.session.sessionUsers.length,vm.originalVMSize=vm.session.vmSize},function(){logError("Unable to get session "+val),gotoSessions()})}function getLabs(forceRefresh){return datacontext.lab.getAll(forceRefresh).then(function(data){return vm.filteredLabs=data})}function getParticipants(forceRefresh){return datacontext.user.getAll(forceRefresh).then(function(data){return vm.filteredParticipants=data})}function gotoLabs(){var aspect=vm.session.entityAspect;aspect.validateProperty("sessionName")&&WizardHandler.wizard().next()}function gotoParticipants(){var aspect=vm.session.entityAspect;aspect.validateEntity()&&WizardHandler.wizard().next()}function gotoSchedule(){var aspect=vm.session.entityAspect;aspect.validateProperty("lab")?(vm.errors=[],WizardHandler.wizard().next()):(vm.errors=aspect.getValidationErrors("lab"),vm.errors.length>0&&(vm.errors[0].errorMessage="Please select a lab"))}function gotoSummary(){function buildErrorMessage(session,sessionCPUs,availableCPUs){var errorMessage="Session requires "+sessionCPUs+" computing cores. Only "+availableCPUs+" computing cores are available when the session is schedule.";return errorMessage+=1===common.vmCoreNumber(vm.session.vmSize)?" Please reschedule the session.":" Please change computing size or reschedule the session."}function calculateEstimatedPrice(){var vmPrice=common.vmPricingHour(vm.session.vmSize),participantsNo=vm.session.sessionUsers.length,duration=moment.duration(vm.session.duration+30,"minutes"),hours=duration.hours();return duration.minutes()>0&&(hours+=1),(participantsNo*hours*vmPrice).toFixed(2)}function checkSessionHasParticipants(){vm.errors=[];var numberOfParticipants=vm.session.sessionUsers.length;return 0==numberOfParticipants?(vm.errors.push({errorMessage:"Each session require at least one participant."}),!1):!0}spinner.spinnerShow(),checkSessionHasParticipants()&&datacontext.getAvailableSubscriptionResources(vm.session.startDate,vm.session.endDate).then(function(availableCPUs){vm.isNew||(availableCPUs+=vm.originalNumberOfUsers*common.vmCoreNumber(vm.originalVMSize));var participantsNo=vm.session.sessionUsers.length,sessionCPUs=participantsNo*common.vmCoreNumber(vm.session.vmSize);sessionCPUs>availableCPUs?vm.errors.push({errorMessage:buildErrorMessage(vm.session,sessionCPUs,availableCPUs)}):(vm.estimatedPrice=calculateEstimatedPrice(),WizardHandler.wizard().next()),spinner.spinnerHide()},function(){spinner.spinnerHide()})}function onDestroy(){$scope.$on("$destroy",function(){datacontext.cancel()})}function removeParticipant(participant){datacontext.session.removeParticipant(vm.session,participant)}var vm=this;vm.filteredLabs=[],vm.session=void 0,vm.selectedParticipant=void 0,vm.filteredParticipants=[],vm.selectedParticipants=[],vm.startTime="",vm.endTime="",vm.addParticipantToSession=addParticipantToSession,vm.createSession=createSession,vm.estimatedPrice=void 0,vm.gotoLabs=gotoLabs,vm.gotoSchedule=gotoSchedule,vm.gotoSummary=gotoSummary,vm.gotoParticipants=gotoParticipants,vm.removeParticipant=removeParticipant,activate()}var controllerId="sessiondetail";angular.module("app").controller(controllerId,["$cookies","$scope","$routeParams","$window","common","config","datacontext","spinner","WizardHandler",sessions])}();
!function(){"use strict";function sessions($routeParams,common,config,datacontext,$location){function activate(){common.activateController([getSessions()],controllerId).then(function(){log("Activated Sessions View")})}function getSessions(forceRefresh){return datacontext.session.getAll(forceRefresh).then(function(data){return vm.sessions=data,applyFilter(),vm.sessions})}function gotoSession(session){session&&session.sessionId&&$location.path("/session/"+session.sessionId)}function applyFilter(){vm.filteredSessions=vm.sessions.filter(sessionFilter)}function sessionFilter(session){return vm.onlyUpcomingSessions?!session.isPassed:!0}function setFilter(){applyFilter()}function removeSession(session){session.removed=!0,datacontext.saveChanges(),getSessions(!1)}var vm=this,getLogFn=common.logger.getLogFn,log=getLogFn(controllerId);vm.setFilter=setFilter,vm.filteredSessions=[],vm.sessions=[],vm.title="Sessions",vm.removeSession=removeSession,activate(),vm.gotoSession=gotoSession}var controllerId="sessions";angular.module("app").controller(controllerId,["$routeParams","common","config","datacontext","$location",sessions])}();
!function(){"use strict";function createUser($scope,$window,$routeParams,common,config,datacontext,spinner){function activate(){onDestroy(),common.activateController([initUser()],controllerId)}function back(){$window.history.back()}function initUser(){var val=$routeParams.id;return"new"===val?void(vm.user=datacontext.user.create()):(vm.isNew=!1,void datacontext.user.getById(val).then(function(data){vm.user=data},function(){logError("Unable to get participant "+val),gotoUsers()}))}function gotoUsers(){$location.path("/participants")}function saveChanges(){function saveSucceded(){spinner.spinnerHide(),$window.history.back()}function saveFailed(){spinner.spinnerHide()}spinner.spinnerShow(),vm.user.password="tnLabsP@ss1",vm.user.entityAspect.validateEntity()&&datacontext.saveChanges().then(saveSucceded,saveFailed)}function onDestroy(){$scope.$on("$destroy",function(){datacontext.cancel()})}{var vm=this,getLogFn=common.logger.getLogFn;getLogFn(controllerId)}vm.isNew=!0,vm.errors=[],vm.user=void 0,vm.saveChanges=saveChanges,vm.back=back,activate()}var controllerId="userdetail";angular.module("app").controller(controllerId,["$scope","$window","$routeParams","common","config","datacontext","spinner",createUser])}();
!function(){"use strict";function users($location,$routeParams,common,config,datacontext){function activate(){common.activateController([getUsers()],controllerId).then(function(){log("Activated Users View")})}function getUsers(forceRefresh){return datacontext.user.getAll(forceRefresh).then(function(data){return vm.filteredUsers=data})}function gotoUser(user){user&&user.userId&&$location.path("/participant/"+user.userId)}function removeUser(user){user.removed=!0,datacontext.saveChanges(),getUsers(!1)}var vm=this,getLogFn=common.logger.getLogFn,log=getLogFn(controllerId);vm.filteredUsers=[],vm.title="users",vm.gotoUser=gotoUser,vm.removeUser=removeUser,activate()}var controllerId="users";angular.module("app").controller(controllerId,["$location","$routeParams","common","config","datacontext",users])}();